{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/react/next-app-router-react-query/",
    "result": {"data":{"cur":{"id":"161feee4-18f2-5161-8900-a9bc5eda4367","html":"<p>ì§€ë‚œ ê¸€ì—ì„œ react-queryì˜ hydrate, dehydrateì„ í†µí•´ ì„œë²„ì—ì„œ prefetching í•œ ë°ì´í„° ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤.</p>\n<blockquote>\n<p><a href=\"https://soobing.github.io/react/server-rendering-and-react-query/\">ì„œë²„ì—ì„œ prefetching í•œ ë°ì´í„° ì‚¬ìš©í•˜ê¸°</a></p>\n</blockquote>\n<p>ì˜¤ëŠ˜ì€ ì¡°ê¸ˆ ì‹¤ìš©ì ìœ¼ë¡œ Next.js 13, 14 ë²„ì „ì˜ app routerì—ì„œ react-queryë¥¼ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ê³  ì„¸íŒ…í•˜ë©´ ì¢‹ì„ì§€ ê³ ë¯¼í–ˆë˜ ë‚´ìš©ì— ëŒ€í•´ì„œ ì´ì•¼ê¸°í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>\n<blockquote>\n<p>í•´ë‹¹ ê¸€ì€ 23ë…„ 10ì›”ì— ë©”ì´ì € ë²„ì „ ì—…ë°ì´íŠ¸ëœ, <a href=\"https://nextjs.org/blog/next-14\">Next.js 14</a>ì™€ <a href=\"https://tanstack.com/blog/announcing-tanstack-query-v5\">React-Query 5</a> ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ëœ ê¸€ì…ë‹ˆë‹¤.</p>\n</blockquote>\n<blockquote>\n<p>ì˜ˆì‹œë¡œ ë³´ì—¬ì£¼ëŠ” ì½”ë“œëŠ” ì €ì˜ <a href=\"https://github.com/soobing/next-14-react-query\">next-14-react-query</a> repoì—ì„œ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n</blockquote>\n<p>ì œê°€ í¬ê²Œ ê³ ë¯¼í–ˆë˜ ë¬¸ì œëŠ” ì•„ë˜ ì„¸ ê°€ì§€ì…ë‹ˆë‹¤.</p>\n<ul>\n<li><code>Hydrate</code> vs <code>ReactQueryStreamedHydration</code> ë‘ ê°€ì§€ API ì¤‘ì— ì–´ë–¤ ê²ƒì„ ì±„íƒí• ê¹Œ?</li>\n<li>Hydration API ì‚¬ìš© ì‹œì— RSC, RCC ëª¨ë‘ì—ì„œ ê¹”ë”í•œ ì½”ë“œë¥¼ ìœ ì§€í•˜ë ¤ë©´ queryOptionì€ ì–´ë–»ê²Œ ì •ì˜í•˜ëŠ” ê²Œ ì¢‹ì„ê¹Œ?</li>\n<li><code>dehydrate(queryClient).queries</code>ì—ëŠ” í˜„ì¬ ê¸°ì¤€ prefetch ëœ(?) ëª¨ë“  ì¿¼ë¦¬ë“¤ì´ ë‹¤ ë”°ë¼ì˜¨ë‹¤ ğŸ˜±</li>\n</ul>\n<p><a href=\"https://jsonplaceholder.typicode.com/\">jsonplaceholder API</a> ì„œë²„ì˜ photo ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì˜ˆì‹œë¡œ í”„ë¡œì íŠ¸ êµ¬ì¡°ë¥¼ ì–´ë–»ê²Œ ì„¤ê³„í–ˆëŠ”ì§€, ê·¸ë¦¬ê³  ìœ„ì—ì„œ í–ˆë˜ ê³ ë¯¼ë“¤ì— ëŒ€í•œ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ  ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>\n<h2 id=\"ì´ˆê¸°-í™˜ê²½-ì„¸íŒ…\" style=\"position:relative;\"><a href=\"#%EC%B4%88%EA%B8%B0-%ED%99%98%EA%B2%BD-%EC%84%B8%ED%8C%85\" aria-label=\"ì´ˆê¸° í™˜ê²½ ì„¸íŒ… permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì´ˆê¸° í™˜ê²½ ì„¸íŒ…</h2>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">/** hooks/useReactQuery.tsx */</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">&#39;use client&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">useState</span><span class=\"mtk1\"> } </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;react&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">QueryClient</span><span class=\"mtk1\">, </span><span class=\"mtk12\">QueryClientProvider</span><span class=\"mtk1\"> } </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@tanstack/react-query&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">ReactQueryDevtools</span><span class=\"mtk1\"> } </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@tanstack/react-query-devtools&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">ReactQueryProviders</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">children</span><span class=\"mtk1\"> }: </span><span class=\"mtk10\">React</span><span class=\"mtk1\">.</span><span class=\"mtk10\">PropsWithChildren</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> [</span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\">] = </span><span class=\"mtk11\">useState</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    () </span><span class=\"mtk4\">=&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">QueryClient</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">defaultOptions:</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk12\">queries:</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// With SSR, we usually want to set some default staleTime</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// above 0 to avoid refetching immediately on the client</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">staleTime:</span><span class=\"mtk1\"> </span><span class=\"mtk7\">60</span><span class=\"mtk1\"> * </span><span class=\"mtk7\">1000</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      }),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">QueryClientProvider</span><span class=\"mtk1\"> </span><span class=\"mtk12\">client</span><span class=\"mtk1\">=</span><span class=\"mtk4\">{</span><span class=\"mtk12\">queryClient</span><span class=\"mtk4\">}</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">{</span><span class=\"mtk12\">children</span><span class=\"mtk4\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">ReactQueryDevtools</span><span class=\"mtk1\"> </span><span class=\"mtk12\">initialIsOpen</span><span class=\"mtk1\">=</span><span class=\"mtk4\">{false}</span><span class=\"mtk1\"> </span><span class=\"mtk17\">/&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;/</span><span class=\"mtk10\">QueryClientProvider</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">/** app/layout.tsx */</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">ReactQueryProviders</span><span class=\"mtk1\"> </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@/hooks/useReactQuery&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">RootLayout</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">children</span><span class=\"mtk1\"> }: </span><span class=\"mtk10\">React</span><span class=\"mtk1\">.</span><span class=\"mtk10\">PropsWithChildren</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">html</span><span class=\"mtk1\"> </span><span class=\"mtk12\">lang</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;en&quot;</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">head</span><span class=\"mtk1\"> </span><span class=\"mtk17\">/&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">body</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">ReactQueryProviders</span><span class=\"mtk17\">&gt;</span><span class=\"mtk4\">{</span><span class=\"mtk12\">children</span><span class=\"mtk4\">}</span><span class=\"mtk17\">&lt;/</span><span class=\"mtk10\">ReactQueryProviders</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk17\">&lt;/</span><span class=\"mtk4\">body</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;/</span><span class=\"mtk4\">html</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h2 id=\"í´ë¼ì´ì–¸íŠ¸-ì„œë²„-ëª¨ë‘ì—ì„œ-ì‚¬ìš©ë -ìˆ˜-ìˆë„ë¡-ì„œë¹„ìŠ¤-ì„¤ê³„í•˜ê¸°\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8-%EC%84%9C%EB%B2%84-%EB%AA%A8%EB%91%90%EC%97%90%EC%84%9C-%EC%82%AC%EC%9A%A9%EB%90%A0-%EC%88%98-%EC%9E%88%EB%8F%84%EB%A1%9D-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%84%A4%EA%B3%84%ED%95%98%EA%B8%B0\" aria-label=\"í´ë¼ì´ì–¸íŠ¸ ì„œë²„ ëª¨ë‘ì—ì„œ ì‚¬ìš©ë  ìˆ˜ ìˆë„ë¡ ì„œë¹„ìŠ¤ ì„¤ê³„í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>í´ë¼ì´ì–¸íŠ¸, ì„œë²„ ëª¨ë‘ì—ì„œ ì‚¬ìš©ë  ìˆ˜ ìˆë„ë¡ ì„œë¹„ìŠ¤ ì„¤ê³„í•˜ê¸°</h2>\n<p><a href=\"https://jsonplaceholder.typicode.com/\">jsonplaceholder API</a> í˜ì´ì§€ë¥¼ ê°€ë³´ë©´, ì„œë¹„ìŠ¤ ë³„ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ë¼ìš°í„° êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆë‹¤ê³  ëª…ì„¸ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 76.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAABXUlEQVQ4y6VTy26DMBDk/z8qyiWHXCmKI4JoK97hZV41EMhUY4mojXqAdKWVV7Z3vOOdNXa7HY7HIw6HA/b7Pdq2BW2eZ9zv981uBEEA13XhOI72aZrwHzPquoaUEk3ToCgKpGmKLMuQJAniONZxnuePs+v1qveiKNL7jOlhGEIpBaOqKk2TK0GYSGciAfhgWZbaub/EBGMhy33m9n0Po+s6jU6bphmO+4EvpV6nTKr8RxqBTEvAD6NflzY15SegUj3E+QLbcRGEMd4/PZSyeoCurnChzArPtoOTsGGdznizhAZfwNaAGmwIZXO73fSn2pcL0jRD03aQVY26brYDLhUSkFpkF59tNWV22fd9jOOIYRgghNAae27G6gqpM9M0tY5U3+vY87zXAXmJAiVdGumqP3S4mjLpcnRKKeEH0UP9rJiTQvr8itUVcl6ZnOcFojhBXhT6gWVmebYF8BtlF4wWzsFQogAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/360e9dafd9cbae4c0b206e41fb05ed71/37523/1.png\"\n        srcset=\"/static/360e9dafd9cbae4c0b206e41fb05ed71/e9ff0/1.png 180w,\n/static/360e9dafd9cbae4c0b206e41fb05ed71/f21e7/1.png 360w,\n/static/360e9dafd9cbae4c0b206e41fb05ed71/37523/1.png 720w,\n/static/360e9dafd9cbae4c0b206e41fb05ed71/302a4/1.png 1080w,\n/static/360e9dafd9cbae4c0b206e41fb05ed71/84bf8/1.png 1162w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ì €ëŠ” photo ì„œë¹„ìŠ¤ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì´ í´ë”ë¥¼ ìƒì„±í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 642px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA8ElEQVQoz52S226FIBRE/QcV8AZSq1LjpV5AjfH/P2tO4DQnbfpQ7cPAflrMDNuL4xhFUaDveyc7E0LAGPuXPHsUxTvmeXYqy/IXkFJ6D5ilKaZpgtYaeZ7D930HDcPwBbfQK2CPEoJISKhugNEay7Jg33f3wLqu6LruVgUOGAuJt0rhcxigjXEwG11KCSHED2d/ufQofQKrpnUO52VxXVpYEAS3YF8OQ0Q8h6wUVqNhjME4jjjPE8dxuNjbtoFzfim6x6IYvPxwMW1/9rbrk2UZ7EolSYI0Ta87ZCxCIiSapkFd12jbFkqp169+15UOH3Y/8kt4v2AQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/a594c1531d9f0cb51f3dc6c58dbf115b/1bba8/2.png\"\n        srcset=\"/static/a594c1531d9f0cb51f3dc6c58dbf115b/e9ff0/2.png 180w,\n/static/a594c1531d9f0cb51f3dc6c58dbf115b/f21e7/2.png 360w,\n/static/a594c1531d9f0cb51f3dc6c58dbf115b/1bba8/2.png 642w\"\n        sizes=\"(max-width: 642px) 100vw, 642px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>APIì˜ ì„œë¹„ìŠ¤ë³„ë¡œ ë”°ë¡œ ê´€ë¦¬í•˜ë©´ ê°€ë…ì„±ê³¼ ìœ ì§€ ë³´ìˆ˜ì— ì¢‹ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ PhotoServiceë¥¼ ì‘ì„±í•˜ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">/** service/photo/PhotoService.ts */</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Service</span><span class=\"mtk1\"> </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@/service/Service&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> {</span><span class=\"mtk12\">Photo</span><span class=\"mtk1\">} </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@/model/photo&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">PhotoService</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Service</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">getPhotos</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">http</span><span class=\"mtk1\">.</span><span class=\"mtk11\">get</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Photo</span><span class=\"mtk1\">[]&gt;(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk8\">`/photos`</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">getPhoto</span><span class=\"mtk1\">(</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">http</span><span class=\"mtk1\">.</span><span class=\"mtk11\">get</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Photo</span><span class=\"mtk1\">&gt;(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk8\">`/photo/</span><span class=\"mtk4\">${</span><span class=\"mtk12\">photoId</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">getComments</span><span class=\"mtk1\">(</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">http</span><span class=\"mtk1\">.</span><span class=\"mtk11\">get</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Comment</span><span class=\"mtk1\">[]&gt;(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk8\">`/photo/</span><span class=\"mtk4\">${</span><span class=\"mtk12\">photoId</span><span class=\"mtk4\">}</span><span class=\"mtk8\">/comments`</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">getComment</span><span class=\"mtk1\">({</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">, </span><span class=\"mtk12\">commentId</span><span class=\"mtk1\">}: {</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">, </span><span class=\"mtk12\">commentId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">}) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">http</span><span class=\"mtk1\">.</span><span class=\"mtk11\">get</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Comment</span><span class=\"mtk1\">[]&gt;(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk8\">`/photo/</span><span class=\"mtk4\">${</span><span class=\"mtk12\">photoId</span><span class=\"mtk4\">}</span><span class=\"mtk8\">/comments/</span><span class=\"mtk4\">${</span><span class=\"mtk12\">commentId</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">PhotoService</span><span class=\"mtk1\">();</span></span></span></code></pre>\n<p>ê·¸ë¦¬ê³  react-queryì˜ useQueryë¥¼ ì‚¬ìš© í•  ë•Œ, í•„ìš”í•œ ê³³ì—ì„œ ì§ì ‘ì ìœ¼ë¡œ í˜¸ì¶œí•´ì„œ ì‚¬ìš©í•˜ê¸°ë³´ë‹¤ëŠ” ì´ ë˜í•œ ì„œë¹„ìŠ¤ë³„ë¡œ Colocate ì‹œì¼œì„œ ê°€ë…ì„±ê³¼ ìœ ì§€ ë³´ìˆ˜í•˜ê¸° ì¢‹ë„ë¡ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.</p>\n<blockquote>\n<p>ê´€ë ¨í•´ì„œ ìœ ëª…í•œ ê¸€ì¸ <a href=\"https://kentcdodds.com/blog/colocation\">Maintainability through colocation</a>Â byÂ <a href=\"https://twitter.com/kentcdodds\">Kent C. Dodds</a>ë¥¼ ì½ì–´ë³´ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤.</p>\n</blockquote>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">/** service/photo/usePhotoService.ts */</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">useQuery</span><span class=\"mtk1\"> } </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@tanstack/react-query&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryOptions</span><span class=\"mtk1\"> </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@/service/photo/queries&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">usePhotos</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk11\">useQuery</span><span class=\"mtk1\">(</span><span class=\"mtk12\">queryOptions</span><span class=\"mtk1\">.</span><span class=\"mtk11\">all</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">usePhoto</span><span class=\"mtk1\">({</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">}: {</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">}) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk11\">useQuery</span><span class=\"mtk1\">(</span><span class=\"mtk12\">queryOptions</span><span class=\"mtk1\">.</span><span class=\"mtk11\">detail</span><span class=\"mtk1\">(</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">useComments</span><span class=\"mtk1\">({</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">}: {</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">}) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk11\">useQuery</span><span class=\"mtk1\">(</span><span class=\"mtk12\">queryOptions</span><span class=\"mtk1\">.</span><span class=\"mtk11\">comments</span><span class=\"mtk1\">(</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">useComment</span><span class=\"mtk1\">({</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">, </span><span class=\"mtk12\">commentId</span><span class=\"mtk1\">}: {</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">, </span><span class=\"mtk12\">commentId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">}) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk11\">useQuery</span><span class=\"mtk1\">(</span><span class=\"mtk12\">queryOptions</span><span class=\"mtk1\">.</span><span class=\"mtk11\">comment</span><span class=\"mtk1\">({</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">, </span><span class=\"mtk12\">commentId</span><span class=\"mtk1\">}));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>ì—¬ê¸°ì„œ queriesë¼ëŠ” íŒŒì¼ì—ì„œ queryOptionì„ ë¹¼ì˜¤ê³  ìˆëŠ”ë°, í•´ë‹¹ íŒŒì¼ì—ì„œëŠ” QueryKeyì™€ QueryOptionì„ ëª¨ë‘ ê´€ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì€ react-queryì˜ ë©”ì¸í…Œì´ë„ˆì¸ TkDodoâ€™s blogì—ì„œ íš¨ìœ¨ì ìœ¼ë¡œ <a href=\"https://tkdodo.eu/blog/effective-react-query-keys\">React Query Key ê´€ë¦¬í•˜ëŠ”  ë²•</a> ì´ë¼ëŠ” ê¸€ì„ ì°¸ê³ í•˜ì—¬ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">PhotoService</span><span class=\"mtk1\"> </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@/service/photo/PhotoService&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryKeys</span><span class=\"mtk1\"> = {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">all:</span><span class=\"mtk1\"> [</span><span class=\"mtk8\">&#39;photos&#39;</span><span class=\"mtk1\">] </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> </span><span class=\"mtk4\">const</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">detail</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> [...</span><span class=\"mtk12\">queryKeys</span><span class=\"mtk1\">.</span><span class=\"mtk12\">all</span><span class=\"mtk1\">, </span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">] </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> </span><span class=\"mtk4\">const</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">detailComments</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> [...</span><span class=\"mtk12\">queryKeys</span><span class=\"mtk1\">.</span><span class=\"mtk11\">detail</span><span class=\"mtk1\">(</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">), </span><span class=\"mtk8\">&#39;comments&#39;</span><span class=\"mtk1\">] </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> </span><span class=\"mtk4\">const</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">detailComment</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> ({</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">, </span><span class=\"mtk12\">commentId</span><span class=\"mtk1\">}: {</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">, </span><span class=\"mtk12\">commentId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">}) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> [...</span><span class=\"mtk12\">queryKeys</span><span class=\"mtk1\">.</span><span class=\"mtk11\">detailComments</span><span class=\"mtk1\">(</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">), </span><span class=\"mtk12\">commentId</span><span class=\"mtk1\">] </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> </span><span class=\"mtk4\">const</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">};</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryOptions</span><span class=\"mtk1\"> = {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">all</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> () </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> ({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">queryKey:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryKeys</span><span class=\"mtk1\">.</span><span class=\"mtk12\">all</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">queryFn</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> () </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">PhotoService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getPhotos</span><span class=\"mtk1\">(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">detail</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> ({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">queryKey:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryKeys</span><span class=\"mtk1\">.</span><span class=\"mtk11\">detail</span><span class=\"mtk1\">(</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">queryFn</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> () </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">PhotoService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getPhoto</span><span class=\"mtk1\">(</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">comments</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> ({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">queryKey:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryKeys</span><span class=\"mtk1\">.</span><span class=\"mtk11\">detailComments</span><span class=\"mtk1\">(</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">queryFn</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> () </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">PhotoService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getComments</span><span class=\"mtk1\">(</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">comment</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> ({</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">, </span><span class=\"mtk12\">commentId</span><span class=\"mtk1\">}: {</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">, </span><span class=\"mtk12\">commentId</span><span class=\"mtk1\">: </span><span class=\"mtk10\">number</span><span class=\"mtk1\">}) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> ({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">queryKey:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryKeys</span><span class=\"mtk1\">.</span><span class=\"mtk11\">detailComment</span><span class=\"mtk1\">({</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">, </span><span class=\"mtk12\">commentId</span><span class=\"mtk1\">}),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">queryFn</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> () </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">PhotoService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getComment</span><span class=\"mtk1\">({</span><span class=\"mtk12\">photoId</span><span class=\"mtk1\">, </span><span class=\"mtk12\">commentId</span><span class=\"mtk1\">}),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">};</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryOptions</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<p>ìœ„ì˜ ê¸€ì—ì„œëŠ” queryKey ê´€ë¦¬ì— ëŒ€í•œ ì´ì•¼ê¸°ë§Œ ë‚˜ì™€ìˆì§€ë§Œ, SSRì´ë‚˜ RSCì—ì„œ Hydrate APIë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ë§ì•„ì ¸ì„œ, queryKeyì™€ ë¹„ìŠ·í•˜ê²Œ queryOptionë„ í•¨ê»˜ ê´€ë¦¬í•˜ë„ë¡ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.</p>\n<h2 id=\"ì„œë²„ì—ì„œ-prefetching-í•˜ê³ -ë°ì´í„°-dehydration-í•˜ê¸°\" style=\"position:relative;\"><a href=\"#%EC%84%9C%EB%B2%84%EC%97%90%EC%84%9C-prefetching-%ED%95%98%EA%B3%A0-%EB%8D%B0%EC%9D%B4%ED%84%B0-dehydration-%ED%95%98%EA%B8%B0\" aria-label=\"ì„œë²„ì—ì„œ prefetching í•˜ê³  ë°ì´í„° dehydration í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì„œë²„ì—ì„œ Prefetching í•˜ê³  ë°ì´í„° de/hydration í•˜ê¸°</h2>\n<p>hydrationì— ëŒ€í•œ ê°œë…ì ì¸ ì„¤ëª…ì€ ì§€ë‚œ ê¸€ì„ ì°¸ê³ í•´ ì£¼ì‹œë©´ ì¢‹ì„ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì„œë²„ì—ì„œ prefetch í•œ ì¿¼ë¦¬ë“¤ì„ dehydrate ì‹œì¼°ë‹¤ê°€ í´ë¼ì´ì–¸íŠ¸ì—ì„œ hydration ì‹œì¼œì¤˜ì•¼ í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ í•´ì£¼ë©´ ì„œë²„ì—ì„œ prefetch í•˜ì—¬ react-queryë¡œ ìºì‹± í•œ ì¿¼ë¦¬ë“¤ì„ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì‚¬ìš©í•  ë•Œë„ ìœ ì§€ë˜ì–´ì„œ refetch í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">HydrationBoundary</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">QueryClient</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">dehydrate</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">QueryState</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">QueryKey</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">} </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@tanstack/react-query&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">cache</span><span class=\"mtk1\"> } </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;react&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">isEqual</span><span class=\"mtk1\"> } </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@/utils&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">getQueryClient</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">cache</span><span class=\"mtk1\">(() </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">QueryClient</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">type</span><span class=\"mtk1\"> </span><span class=\"mtk10\">UnwrapPromise</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">T</span><span class=\"mtk1\">&gt; = </span><span class=\"mtk10\">T</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Promise</span><span class=\"mtk1\">&lt;</span><span class=\"mtk4\">infer</span><span class=\"mtk1\"> </span><span class=\"mtk10\">U</span><span class=\"mtk1\">&gt; ? </span><span class=\"mtk10\">U</span><span class=\"mtk1\"> : </span><span class=\"mtk10\">T</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">interface</span><span class=\"mtk1\"> </span><span class=\"mtk10\">QueryProps</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ResponseType</span><span class=\"mtk1\"> = </span><span class=\"mtk10\">unknown</span><span class=\"mtk1\">&gt; {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">queryKey</span><span class=\"mtk1\">: </span><span class=\"mtk10\">QueryKey</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">queryFn</span><span class=\"mtk1\">: () </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Promise</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ResponseType</span><span class=\"mtk1\">&gt;;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">interface</span><span class=\"mtk1\"> </span><span class=\"mtk10\">DehydratedQueryExtended</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">TData</span><span class=\"mtk1\"> = </span><span class=\"mtk10\">unknown</span><span class=\"mtk1\">, </span><span class=\"mtk10\">TError</span><span class=\"mtk1\"> = </span><span class=\"mtk10\">unknown</span><span class=\"mtk1\">&gt; {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">state</span><span class=\"mtk1\">: </span><span class=\"mtk10\">QueryState</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">TData</span><span class=\"mtk1\">, </span><span class=\"mtk10\">TError</span><span class=\"mtk1\">&gt;;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk4\">async</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">getDehydratedQuery</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Q</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">QueryProps</span><span class=\"mtk1\">&gt;({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">queryKey</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">queryFn</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}: </span><span class=\"mtk10\">Q</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">getQueryClient</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\">.</span><span class=\"mtk11\">prefetchQuery</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">queryKey</span><span class=\"mtk1\">, </span><span class=\"mtk12\">queryFn</span><span class=\"mtk1\"> });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">queries</span><span class=\"mtk1\"> } = </span><span class=\"mtk11\">dehydrate</span><span class=\"mtk1\">(</span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> [</span><span class=\"mtk12\">dehydratedQuery</span><span class=\"mtk1\">] = </span><span class=\"mtk12\">queries</span><span class=\"mtk1\">.</span><span class=\"mtk11\">filter</span><span class=\"mtk1\">((</span><span class=\"mtk12\">query</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">isEqual</span><span class=\"mtk1\">(</span><span class=\"mtk12\">query</span><span class=\"mtk1\">.</span><span class=\"mtk12\">queryKey</span><span class=\"mtk1\">, </span><span class=\"mtk12\">queryKey</span><span class=\"mtk1\">),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">dehydratedQuery</span><span class=\"mtk1\"> </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> </span><span class=\"mtk10\">DehydratedQueryExtended</span><span class=\"mtk1\">&lt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">UnwrapPromise</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ReturnType</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Q</span><span class=\"mtk1\">[</span><span class=\"mtk8\">&#39;queryFn&#39;</span><span class=\"mtk1\">]&gt;&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &gt;;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Hydrate</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">HydrationBoundary</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> {};</span></span></span></code></pre>\n<p>ìœ„ì˜ ì½”ë“œì—ì„œëŠ” <code>getQueryClient</code>ì™€ <code>getDehydratedQuery</code> ë‘ ê°€ì§€ í•¨ìˆ˜ë¥¼ ìœ í‹¸ë¡œ export í•˜ê³  ìˆìŠµë‹ˆë‹¤. <code>getQueryClient</code> ìœ í‹¸ì€ <a href=\"https://tanstack.com/query/latest/docs/react/guides/advanced-ssr#alternative-use-a-single-queryclient-for-prefetching\">ê³µì‹ ë¬¸ì„œì—ì„œ ê¶Œì¥</a> í•˜ê³  ìˆë“¯ì´, ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ fetching í•  ë•Œ ë§ˆë‹¤ í•„ìš”í•œ queryClientë¥¼ cache í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í–ˆìŠµë‹ˆë‹¤.</p>\n<p><code>getDehydratedQuery</code>ëŠ” queryClientë¥¼ ì´ìš©í•˜ì—¬ ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ prefetching í•˜ê³  dehydrate í•œ ê²°ê³¼ë¬¼ì„ ë¦¬í„´í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.</p>\n<p>ìœ„ ìœ í‹¸ì„ ì‚¬ìš©í•˜ì—¬ SSRì„ ìˆ˜í–‰í•˜ê³  ìˆëŠ” page.tsx íŒŒì¼ì—ì„œ ì„œë²„ì—ì„œ prefeching í•œ ë°ì´í„°ë¥¼ hydration ì‹œì¼°ì„ ë•Œ ì•„ë˜ì™€ ê°™ì´ inactive ìƒíƒœë¡œ ë³´ì´ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Image</span><span class=\"mtk1\"> </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;next/image&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">styles</span><span class=\"mtk1\"> </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;./page.module.css&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">PhotoList</span><span class=\"mtk1\"> </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@/components/PhotoList&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryOptions</span><span class=\"mtk1\"> </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@/service/photo/queries&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">Hydrate</span><span class=\"mtk1\">, </span><span class=\"mtk12\">getDehydratedQuery</span><span class=\"mtk1\"> } </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@/utils/react-query&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk4\">async</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">Home</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">queryKey</span><span class=\"mtk1\">, </span><span class=\"mtk12\">queryFn</span><span class=\"mtk1\"> } = </span><span class=\"mtk12\">queryOptions</span><span class=\"mtk1\">.</span><span class=\"mtk11\">all</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">query</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk11\">getDehydratedQuery</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">queryKey</span><span class=\"mtk1\">, </span><span class=\"mtk12\">queryFn</span><span class=\"mtk1\"> });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">main</span><span class=\"mtk1\"> </span><span class=\"mtk12\">className</span><span class=\"mtk1\">=</span><span class=\"mtk4\">{</span><span class=\"mtk12\">styles</span><span class=\"mtk1\">.</span><span class=\"mtk12\">main</span><span class=\"mtk4\">}</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">     ...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">{</span><span class=\"mtk3\">/* ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ &amp; ì„œë²„ ì»´í¬ë„ŒíŠ¸ */</span><span class=\"mtk4\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">Hydrate</span><span class=\"mtk1\"> </span><span class=\"mtk12\">state</span><span class=\"mtk1\">=</span><span class=\"mtk4\">{</span><span class=\"mtk1\">{ </span><span class=\"mtk12\">queries:</span><span class=\"mtk1\"> [</span><span class=\"mtk12\">query</span><span class=\"mtk1\">] }</span><span class=\"mtk4\">}</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">{</span><span class=\"mtk3\">/* Client Component ì ì‹œ ì£¼ì„ì²˜ë¦¬ */</span><span class=\"mtk4\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">{</span><span class=\"mtk3\">/* &lt;PhotoList/&gt; */</span><span class=\"mtk4\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;/</span><span class=\"mtk10\">Hydrate</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;/</span><span class=\"mtk4\">main</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAArUlEQVQY01WOSw7DIAwFc/8DdtNtqxDAQMCYTxevwpGqdDGyZT2PvT0fD9jDwLiI/SAYG1Clo/eJWAosRfjI2G3AbgkUGK/dg+IJ5zwsJfiQYH0E14aNDoPKjHheLKGjhFIbUmEVsnQNL6QNFBZI6xBpyCygmOHDqfPtbTwOdy2tz1JmhJQ1uKRnqWh9oI/5R1t1flSci2heP6yyLssvOOZH+VvuU6UX935c4htfIGszoYYKzU0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/9e8685c928e2c32961adbe8d393c2250/37523/3.png\"\n        srcset=\"/static/9e8685c928e2c32961adbe8d393c2250/e9ff0/3.png 180w,\n/static/9e8685c928e2c32961adbe8d393c2250/f21e7/3.png 360w,\n/static/9e8685c928e2c32961adbe8d393c2250/37523/3.png 720w,\n/static/9e8685c928e2c32961adbe8d393c2250/302a4/3.png 1080w,\n/static/9e8685c928e2c32961adbe8d393c2250/07a9c/3.png 1440w,\n/static/9e8685c928e2c32961adbe8d393c2250/7db30/3.png 1494w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><code>Hydrate</code> ë‚´ë¶€ì˜ <code>&#x3C;PhotoList/></code>ë¥¼ ì£¼ì„ í•´ì œí•´ ë³´ë©´, Client ì»´í¬ë„ŒíŠ¸ì—ì„œ ë™ì¼í•œ ì¿¼ë¦¬ë¥¼ ìš”ì²­í–ˆì„ ë•Œ active ìƒíƒœë¡œ ë°”ë€ŒëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk4\">async</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">Home</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">queryKey</span><span class=\"mtk1\">, </span><span class=\"mtk12\">queryFn</span><span class=\"mtk1\"> } = </span><span class=\"mtk12\">queryOptions</span><span class=\"mtk1\">.</span><span class=\"mtk11\">all</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">query</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk11\">getDehydratedQuery</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">queryKey</span><span class=\"mtk1\">, </span><span class=\"mtk12\">queryFn</span><span class=\"mtk1\"> });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">main</span><span class=\"mtk1\"> </span><span class=\"mtk12\">className</span><span class=\"mtk1\">=</span><span class=\"mtk4\">{</span><span class=\"mtk12\">styles</span><span class=\"mtk1\">.</span><span class=\"mtk12\">main</span><span class=\"mtk4\">}</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">     ...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">{</span><span class=\"mtk3\">/* ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ &amp; ì„œë²„ ì»´í¬ë„ŒíŠ¸ */</span><span class=\"mtk4\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">Hydrate</span><span class=\"mtk1\"> </span><span class=\"mtk12\">state</span><span class=\"mtk1\">=</span><span class=\"mtk4\">{</span><span class=\"mtk1\">{ </span><span class=\"mtk12\">queries:</span><span class=\"mtk1\"> [</span><span class=\"mtk12\">query</span><span class=\"mtk1\">] }</span><span class=\"mtk4\">}</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">{</span><span class=\"mtk3\">/* Client Component ì ì‹œ ì£¼ì„ì²˜ë¦¬ */</span><span class=\"mtk4\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">PhotoList</span><span class=\"mtk17\">/&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;/</span><span class=\"mtk10\">Hydrate</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;/</span><span class=\"mtk4\">main</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAm0lEQVQY04WOyQrDMAxE8/+/WHooDdSJF3nfepgiOwk9FHp4iBEzIy2P+w1CKKyrxPqUsBSRS0Uq9ZqSLIQ12MnjtSmQjRA7QRuC0gRlHKS20OSxeOcRYoYLaSw3aeAPTS6gtj5KJw0xFZTaEPM8yLCXS0fhthOs56+m2YeEmMsgHOFS+wUf4N2cU3PpmVlYlNbR+vsnHPjHt/8D5Mo0vXjyLjUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/f2dc2c528da71e3981f0b7264934b25d/37523/4.png\"\n        srcset=\"/static/f2dc2c528da71e3981f0b7264934b25d/e9ff0/4.png 180w,\n/static/f2dc2c528da71e3981f0b7264934b25d/f21e7/4.png 360w,\n/static/f2dc2c528da71e3981f0b7264934b25d/37523/4.png 720w,\n/static/f2dc2c528da71e3981f0b7264934b25d/302a4/4.png 1080w,\n/static/f2dc2c528da71e3981f0b7264934b25d/07a9c/4.png 1440w,\n/static/f2dc2c528da71e3981f0b7264934b25d/27f8b/4.png 1730w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>hydrationì´ ì œëŒ€ë¡œ ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ì‚¬ì‹¤ hydration ëª©ì  ì´ì™¸ì—ë„ prefetching í•œ response ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ì ‘ê·¼í•´ì„œ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. <code>query.state.data</code>  í˜•íƒœë¡œ ì§ì ‘ ì ‘ê·¼í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p><code>dehydrate</code> í•¨ìˆ˜ë¥¼ ë³´ë©´ queryClientë¡œ prefetchëœ ëª¨ë“  ë°ì´í„°ë¥¼ ì „ë¶€ ë°˜í™˜í•˜ë¯€ë¡œ ë§Œì•½ í•„í„°ë§ ì—†ì´ ë‹¤ìŒê³¼ ê°™ì´ ëª¨ë“  queryë¥¼ ë¦¬í„´í•œë‹¤ë©´ SSRì„ í•˜ëŠ” í˜ì´ì§€ ë‹¨ì—ì„œ, ê·¸ë¦¬ê³  ë‚´ë¶€ì— ì„œë²„ ì»´í¬ë„ŒíŠ¸ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš° ê°ê° dehydrateë¥¼ í•œë‹¤ë©´í•´ë‹¹ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ì ‘ê·¼í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ìˆœì„œë¥¼ ì•Œê¸° ì–´ë ¤ì›Œ ì•„ë˜ì™€ ê°™ì´ ìœ í‹¸ì„ ì‘ì„±í•˜ì§€ ì•Šê³  í•„í„°ë§í•˜ë„ë¡ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// [ì°¸ê³ ìš©] filtering í•˜ì§€ ì•Šê³  ëª¨ë“  dehydrated queryë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk4\">async</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">getDehydratedQueries</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Q</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">QueryProps</span><span class=\"mtk1\">[]&gt;(</span><span class=\"mtk12\">queries</span><span class=\"mtk1\">: </span><span class=\"mtk10\">Q</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">getQueryClient</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Promise</span><span class=\"mtk1\">.</span><span class=\"mtk11\">all</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">queries</span><span class=\"mtk1\">.</span><span class=\"mtk11\">map</span><span class=\"mtk1\">(({ </span><span class=\"mtk12\">queryKey</span><span class=\"mtk1\">, </span><span class=\"mtk12\">queryFn</span><span class=\"mtk1\"> }) </span><span class=\"mtk4\">=&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\">.</span><span class=\"mtk11\">prefetchQuery</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">queryKey</span><span class=\"mtk1\">, </span><span class=\"mtk12\">queryFn</span><span class=\"mtk1\"> }),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk11\">dehydrate</span><span class=\"mtk1\">(</span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\">).</span><span class=\"mtk12\">queries</span><span class=\"mtk1\"> </span><span class=\"mtk15\">as</span><span class=\"mtk1\"> </span><span class=\"mtk10\">DehydratedQueryExtended</span><span class=\"mtk1\">&lt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">UnwrapPromise</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ReturnType</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Q</span><span class=\"mtk1\">[</span><span class=\"mtk10\">number</span><span class=\"mtk1\">][</span><span class=\"mtk8\">&#39;queryFn&#39;</span><span class=\"mtk1\">]&gt;&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  &gt;[];</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>ìœ„ì˜ ìœ í‹¸ì„ ì‚¬ìš©í•œ <code>Comments</code> ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚´í´ë³´ë©´ ì•„ë˜ ì²¨ë¶€í•œ ì´ë¯¸ì§€ì²˜ëŸ¼ ë‘ ê°œì˜ ë°ì´í„°ê°€ ë“¤ì–´ì˜¤ê³  ìˆìŠµë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> {</span><span class=\"mtk12\">Photo</span><span class=\"mtk1\">} </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@/model/photo&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> {</span><span class=\"mtk12\">Hydrate</span><span class=\"mtk1\">, </span><span class=\"mtk12\">getDehydratedQueries</span><span class=\"mtk1\">} </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@/utils/react-query&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryOptions</span><span class=\"mtk1\"> </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@/service/photo/queries&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk4\">async</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">Comments</span><span class=\"mtk1\">({</span><span class=\"mtk12\">id</span><span class=\"mtk1\">}: </span><span class=\"mtk10\">Pick</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Photo</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;id&#39;</span><span class=\"mtk1\">&gt;) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">queryKey</span><span class=\"mtk1\">, </span><span class=\"mtk12\">queryFn</span><span class=\"mtk1\"> } = </span><span class=\"mtk12\">queryOptions</span><span class=\"mtk1\">.</span><span class=\"mtk11\">comments</span><span class=\"mtk1\">(</span><span class=\"mtk12\">id</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queries</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk11\">getDehydratedQueries</span><span class=\"mtk1\">([{ </span><span class=\"mtk12\">queryKey</span><span class=\"mtk1\">, </span><span class=\"mtk12\">queryFn</span><span class=\"mtk1\"> }]);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">Hydrate</span><span class=\"mtk1\"> </span><span class=\"mtk12\">state</span><span class=\"mtk1\">=</span><span class=\"mtk4\">{</span><span class=\"mtk1\">{ </span><span class=\"mtk12\">queries</span><span class=\"mtk1\"> }</span><span class=\"mtk4\">}</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      comments</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">{</span><span class=\"mtk10\">JSON</span><span class=\"mtk1\">.</span><span class=\"mtk11\">stringify</span><span class=\"mtk1\">(</span><span class=\"mtk12\">queries</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">].</span><span class=\"mtk12\">state</span><span class=\"mtk1\">.</span><span class=\"mtk12\">data</span><span class=\"mtk1\">)</span><span class=\"mtk4\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;/</span><span class=\"mtk10\">Hydrate</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 138.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAYAAABh2p9gAAAACXBIWXMAAAsTAAALEwEAmpwYAAAESklEQVRIx42WS3vaVhRFPW+d2JLuQyCwECAQoIcFQjzD09hJ3I466KT//2esfleQxG0Sx4PzXSGJxbk6e29xVWs2mOU5H3c7trMZ+XBIFkWMh0PSXo95nlfnVpMJsywj9H2klGit0Uqd1xd1tWw22biae8tiYttMHYfScc6rlF9rrhSFUhwch76UOD8Dzs0NrRaTsiSOY1yvgVPzcNwajhBIpVBaVV+2tCIRgpEQ2D8DToWg7jgU0ykf1iv6+YRgXBIWc9pBG8/TSOkiHMWN0MRCMJSvAGdCULNtirLk+fmZz58/8/R4Yr8/kCRtDgfJeq3Y7wSztSKvKQavdVgKgWe2EcfM53OKouDx8bHafhC06HRc2m3NXVPhNjWpUgzfBEySCmhgx+OR3W5PUSSMRi5KSWxLYKnLln8FNM8wzTJ2ux37/Z7lcsnhcGC73VAUQ7IsJGi1vw7lTcAkTdlsNhwfHpiMx+w2W/bbPUHQZjQaMRoOK0gFlPLXwDhNq67W6zWz9YL5dkM2DSkmFkGgcGyB7eq3d2iGYjqcFgXdbEQ9DnHyEC9q47oaV+tvHb6qQ9um63n0ej36psKQUTTAbzbRrQa1oElNaWpKVe5IL8I2x646C15X4j//wFV+e0s/ipgdDiyPR+Ki4PauwXU54Hoxwo5DVDvgRil+c116Ulb1TusKajr9AjPr1U5K/vR9TkHAcxjyqdNhqRVz32PebjD36yyUZGmf/f2HZbG17crPRkKmvJcdHpXiY7PJ3vP4oDVzy2Jh6uaWxY3F0rJYOjZL4ZzLccgu2zZQAx+8mPpVaduIep3xek1WltidHtfhgPfdPjdujd+Fey5HV/Vea6zLdt+5bjWg6CVwKQTKtimNlz994uHpI+vDke3pifH9iLJQjAaa0VAyiBR19zwEMxADyf4PXDgOWohK2EaD89mM0/HAfZpxd6cpCsV0KilLyXis8LwaygD1GZh+BxTiDEwSVqtVZb+npyfKckaWpXS7NVzXxbI0jqMr2Je0fh146fB0OrHdbnl4OLFY5IzHLXzfRUoDOsPURXuvAk04GKeYyvO8CobD4bHy8XR6Txwn37p7S4dxklRJY+JrvVpVwbBa5AwiSRA08bzGt+5+BVSXtDFAkzRRkdGd5TTHbeL7WrVlISTaPbvC1Bdvpz+ack0aSUQUkwnTSUGa3+MHLcSgjQzbSHGWiWsLXEfgmtfo5c33nWxKy6IdhgzznH6ScNfpoBoNrH6AFQU4foNm4GL7DW7TLrejDlbQpOG3uP6RsI3Vjp0Of69W/LPb8VdZMmnWScc90vmA+0FA0fGqNdkkpEWfrOczdd3Kxwfb/i+w5/vE9TpdE2O2TSjEOVEcQc92quNQqsq3fduh7wj6Qlb3VeekrKLtazgor0Z3OCCfThkkCd0oYpimRHFMJ4qqz4HJyCyjNxoRJUl1Pc5zkjznrt1GXP6amPj6F35XELJ5fBz9AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/2d804deab0f591d646cbc8ed0d21f159/37523/5.png\"\n        srcset=\"/static/2d804deab0f591d646cbc8ed0d21f159/e9ff0/5.png 180w,\n/static/2d804deab0f591d646cbc8ed0d21f159/f21e7/5.png 360w,\n/static/2d804deab0f591d646cbc8ed0d21f159/37523/5.png 720w,\n/static/2d804deab0f591d646cbc8ed0d21f159/64d87/5.png 818w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"ëœ-ë³µì¡í•œ-ì½”ë“œë¥¼-ì‘ì„±í• -ìˆœ-ì—†ì„ê¹Œ-reactquerystreamedhydration\" style=\"position:relative;\"><a href=\"#%EB%8D%9C-%EB%B3%B5%EC%9E%A1%ED%95%9C-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%9E%91%EC%84%B1%ED%95%A0-%EC%88%9C-%EC%97%86%EC%9D%84%EA%B9%8C-reactquerystreamedhydration\" aria-label=\"ëœ ë³µì¡í•œ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆœ ì—†ì„ê¹Œ reactquerystreamedhydration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ëœ ë³µì¡í•œ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆœ ì—†ì„ê¹Œ? (ReactQueryStreamedHydration)</h2>\n<p>ëìœ¼ë¡œ, ì´ë ‡ê²Œ dehydrate, hydrate ì§ì ‘ ì‹œì¼œì¤˜ì•¼ í•˜ëŠ” ì½”ë“œê°€ ì‹¬í”Œí•˜ì§€ ëª»í•˜ë‹¤ê³  ìƒê°í•˜ì—¬ ë” ì¢‹ì€ ë°©ë²•ì´ ì—†ëŠ”ê°€ ê²€ìƒ‰í•˜ë˜ ì¤‘ì— <a href=\"https://tanstack.com/query/v5/docs/react/guides/advanced-ssr#experimental-streaming-without-prefetching-in-nextjs\">ReactQueryStreamedHydration</a>ì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤. prefetching ì—†ì´ë„ streaming SSRì„ ì‘ë™ ì‹œí‚¤ëŠ” ë°©ë²•ì¸ë°, ì´ íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ˆê¸° ìš”ì²­ ë™ì•ˆ ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  (useQuery í›…ì—ì„œì˜ API í˜¸ì¶œì´ ì„œë²„ì—ì„œ ì´ë£¨ì–´ì§) ë°ì´í„°ê°€ ì¤€ë¹„ë˜ë©´ QueryClientì— ì „ë‹¬í•˜ì—¬ rootì—ì„œ hydrationì„ ìˆ˜í–‰í•˜ê¸° ë•Œë¬¸ì— ì»´í¬ë„ŒíŠ¸ì—ì„œ useSuspenseQueryë¥¼ í˜¸ì¶œí•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤. CSRì—ì„œ react-queryë¥¼ ì‚¬ìš©í•˜ë“¯ì´ ì½”ë“œê°€ ì—„ì²­ë‚˜ê²Œ ê°„ë‹¨í•´ì§‘ë‹ˆë‹¤. ì´ëŠ” ë†€ë¼ìš´ ê°œë°œ ê²½í—˜(DX)ê³¼ ë‚®ì€ ì½”ë“œ ë³µì¡ì„±ì„ ì œê³µí•©ë‹ˆë‹¤.</p>\n<p>ê·¸ëŸ¬ë‚˜ ì´ ë°©ë²•ì„ ì„ íƒí•˜ì§€ ì•Šì€ ì´ìœ ëŠ”, ì‹¤í—˜ ë‹¨ê³„ ì¸ì ì´ ê°€ì¥ ì»¸ê³  ê¹Šê²Œ ì¤‘ì²©ëœ ì¿¼ë¦¬ê°€ ì—†ê³  ìš”ì²­ ìµœì í™”ë¥¼ ì˜ ê´€ë¦¬í•˜ê³  ìˆëŠ” ê²½ìš° ì‚¬ìš©í•˜ê¸°ë¥¼ ê¶Œì¥í•˜ê³  ìˆëŠ”ë° ë”°ë¡œ ì˜ ê´€ë¦¬í•  ìì‹ ì´ ì—†ì—ˆë˜ ì ì´ ì œì¼ ì»¸ìŠµë‹ˆë‹¤. ì¡°ê¸ˆ ë” ìì„¸íˆ ì•Œì•„ë³´ê³  ì‹¶ìœ¼ì‹  ë¶„ë“¤ì€ ê³µì‹ ë¬¸ì„œì™€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì½”ë“œë¥¼ ì°¸ê³ í•˜ì‹œë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤ :)</p>\n<h2 id=\"ì°¸ê³ ìë£Œ\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\" aria-label=\"ì°¸ê³ ìë£Œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì°¸ê³ ìë£Œ</h2>\n<ul>\n<li>(ê³µì‹ë¬¸ì„œ) <a href=\"https://tanstack.com/query/latest/docs/react/guides/advanced-ssr\">Advanced Server Rendering</a></li>\n<li>(ê³µì‹ë¬¸ì„œ) <a href=\"https://tanstack.com/query/v5/docs/react/guides/advanced-ssr#experimental-streaming-without-prefetching-in-nextjs\">Experimental streaming without prefetching in Next.js</a></li>\n<li>ì˜ˆì œ ì½”ë“œ êµ¬í˜„: <a href=\"https://github.com/soobing/next-14-react-query\">https://github.com/soobing/next-14-react-query</a> by soobing</li>\n</ul>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .default-dark .mtk3 { color: #6A9955; }\n  .default-dark .mtk8 { color: #CE9178; }\n  .default-dark .mtk15 { color: #C586C0; }\n  .default-dark .mtk1 { color: #D4D4D4; }\n  .default-dark .mtk12 { color: #9CDCFE; }\n  .default-dark .mtk4 { color: #569CD6; }\n  .default-dark .mtk11 { color: #DCDCAA; }\n  .default-dark .mtk10 { color: #4EC9B0; }\n  .default-dark .mtk7 { color: #B5CEA8; }\n  .default-dark .mtk17 { color: #808080; }\n  .default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","excerpt":"ì§€ë‚œ ê¸€ì—ì„œ react-queryì˜ hydrate, dehydrateì„ í†µí•´ ì„œë²„ì—ì„œ prefetching í•œ ë°ì´í„° ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ì„œë²„ì—ì„œ prefetching í•œ ë°ì´í„° ì‚¬ìš©í•˜ê¸° ì˜¤ëŠ˜ì€ ì¡°ê¸ˆ ì‹¤ìš©ì ìœ¼ë¡œ Next.js 13, 14 ë²„ì „ì˜ app routerì—ì„œ react-queryë¥¼ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ê³  ì„¸íŒ…í•˜ë©´ ì¢‹ì„ì§€ ê³ ë¯¼í–ˆë˜ ë‚´ìš©ì— ëŒ€í•´ì„œ ì´ì•¼ê¸°í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. í•´ë‹¹ ê¸€ì€ 23ë…„ 10ì›”ì— ë©”ì´ì € ë²„ì „ ì—…ë°ì´íŠ¸ëœ, Next.js 14ì™€ React-Query 5 ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ëœ ê¸€ì…ë‹ˆë‹¤. ì˜ˆì‹œë¡œ ë³´ì—¬ì£¼ëŠ” ì½”ë“œëŠ” ì €ì˜ next-14-react-query repoì—ì„œ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì œê°€ í¬ê²Œ ê³ ë¯¼í–ˆë˜ ë¬¸ì œëŠ” ì•„ë˜ ì„¸ ê°€ì§€ì…ë‹ˆë‹¤. Hydrate vs ReactQueryStreamedHydration ë‘ ê°€ì§€ API ì¤‘ì— ì–´ë–¤ ê²ƒì„ ì±„íƒí• ê¹Œ? Hydration API ì‚¬ìš© ì‹œì— RSC, RCC ëª¨ë‘ì—ì„œ ê¹”ë”í•œ ì½”ë“œë¥¼ ìœ ì§€í•˜ë ¤ë©´ queryOptionì€ â€¦","frontmatter":{"date":"January 07, 2024","title":"[React-Query] Next.js app routerì—ì„œ ì‚¬ìš©í•˜ë©´ì„œ ê³ ë¯¼í–ˆë˜ ê²ƒë“¤","categories":"react","author":"soobing"},"fields":{"slug":"/react/next-app-router-react-query/"}},"next":{"id":"d77b67b4-3ea0-53b0-b513-8a24dd4da08d","html":"<p>Next.jsë‚˜ Remix ê°™ì€ í”„ë ˆì„ì›Œí¬ ë‚´ì—ì„œ React-Queryë¥¼ ì‚¬ìš©í•œë‹¤ë©´, ì„œë²„ ë Œë”ë§ ë  ë•Œ ìš”ì²­ í›„ ì‘ë‹µë°›ì€ ë°ì´í„°ë¥¼ SPA ë°©ì‹ìœ¼ë¡œ ì „í™˜ë˜ê³  ë‚˜ì„œë„ ìœ ì§€í•  ìˆ˜ ìˆì„ê¹Œìš”? ì–´ë–»ê²Œ ê°€ëŠ¥í• ê¹Œìš”? React Queryì˜ <code>hydrate</code>ì™€ <code>dehydrate</code>ëŠ” ì„œë²„ì—ì„œ ë¯¸ë¦¬ ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œ ì¬ì‚¬ìš© í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤. ì´ë²ˆ ê¸€ì„ í†µí•´ ì„œë²„ ë Œë”ë§ê³¼ ì–´ë–»ê²Œ ì´ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ”ì§€ <code>hydrate</code>ì™€ <code>dehydrate</code>ì—  ëŒ€í•´ì„œ ì•Œì•„ë´…ì‹œë‹¤.</p>\n<h2 id=\"server-rendering\" style=\"position:relative;\"><a href=\"#server-rendering\" aria-label=\"server rendering permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Server Rendering</h2>\n<p>ì„œë²„ ë Œë”ë§ì€ ì‚¬ìš©ìê°€ í˜ì´ì§€ë¥¼ ë¡œë“œí•˜ëŠ” ì¦‰ì‹œ ë³¼ ìˆ˜ ìˆëŠ” ì´ˆê¸° HTMLì„ ì„œë²„ì—ì„œ ìƒì„±í•˜ëŠ” í–‰ìœ„ì…ë‹ˆë‹¤. ì´ëŠ” í˜ì´ì§€ ìš”ì²­ ì‹œ ì¦‰ì‹œ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë©°(SSR), ì´ì „ ìš”ì²­ì´ ìºì‹œ ë˜ì—ˆê±°ë‚˜ ë¹Œë“œ ì‹œê°„ì— ë¯¸ë¦¬ ìƒì„±(SSG) í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>\n<p>í´ë¼ì´ì–¸íŠ¸ ë Œë”ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ì‚¬ìš©ìì—ê²Œ í™”ë©´ì— ì½˜í…ì¸ ë¥¼ í‘œì‹œí•˜ê¸° ì „ì— ìµœì†Œ 3ë²ˆì˜ ì„œë²„ ì™•ë³µ(roundtrips)ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"bash\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">1. |-&gt; Markup (ë‚´ìš© ì—†ì´ - ë¹„ì–´ìˆëŠ” index.html)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">2.   |-&gt; JS</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">3.     |-&gt; Query</span></span></span></code></pre>\n<p>ì„œë²„ ë Œë”ë§ì€ ìœ„ì˜ ê³¼ì •ì„ ì•„ë˜ì™€ ê°™ì´ ê°™ì´ ë³€í™˜í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"bash\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">1. |-&gt; Markup (ë‚´ìš©ì´ ì±„ì›Œì ¸ìˆê³ , dataê°€ ì´ˆê¸°í™” ë˜ì–´ìˆìŒ)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">2.   |-&gt; JS</span></span></span></code></pre>\n<p>1ë²ˆì´ ì™„ë£Œë˜ë©´ ì‚¬ìš©ìëŠ” ì½˜í…ì¸ ë¥¼ ë³¼ ìˆ˜ ìˆê³ , 2ë²ˆì´ ëë‚˜ë©´ í˜ì´ì§€ê°€ ìƒí˜¸ì‘ìš© ê°€ëŠ¥í•˜ê³  í´ë¦­í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤. ë§ˆí¬ì—…ì— í•„ìš”í•œ ì´ˆê¸° ë°ì´í„°ê°€ í¬í•¨ë˜ì–´ ìˆê¸° ë•Œë¬¸ì—, ì ì–´ë„ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ê²€ì¦í•  í•„ìš”ê°€ ìˆì„ ë•Œê¹Œì§€ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ì„œ 3ë²ˆì„ ì‹¤í–‰í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.</p>\n<p>ì„œë²„ ë Œë”ë§ì„ í†µí•´ 1ë²ˆ ê³¼ì •ì—ì„œ ë‚´ìš©ì´ ì±„ì›Œì ¸ ìˆê³  dataê°€ ì´ˆê¸°í™”ë˜ì–´ìˆëŠ” htmlì„ ìƒì„±í•˜ê¸° ìœ„í•´ì„œëŠ” ë§ˆí¬ì—…ì„ ìƒì„±/ë Œë”ë§ í•˜ê¸° ì „ì— í•´ë‹¹ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ê°€ì ¸ì™€ì•¼(prefetch) í•˜ë©°, ë°ì´í„°ë¥¼ ì§ë ¬í™” ê°€ëŠ¥í•œ(serializable) í˜•ì‹ìœ¼ë¡œ dehydrate ì‹œì¼œ ë§ˆí¬ì—…ì— í¬í•¨(embed) ì‹œí‚¤ê³ , í´ë¼ì´ì–¸íŠ¸ì—ì„œëŠ” React Query ìºì‹œë¡œ í•´ë‹¹ ë°ì´í„°ë¥¼ hydrate í•˜ì—¬ ìƒˆë¡œìš´ fetchë¥¼ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì¶”ê°€ì ìœ¼ë¡œ í•  í•„ìš”ê°€ ì—†ë„ë¡ í•´ì•¼ í•©ë‹ˆë‹¤.</p>\n<h2 id=\"initialdata-ë¥¼-ì‚¬ìš©í•˜ì—¬-ì„œë²„ì—ì„œ-fetchí•œ-ë°ì´í„°-ì‚¬ìš©í•˜ê¸°\" style=\"position:relative;\"><a href=\"#initialdata-%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EC%84%9C%EB%B2%84%EC%97%90%EC%84%9C-fetch%ED%95%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"initialdata ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë²„ì—ì„œ fetchí•œ ë°ì´í„° ì‚¬ìš©í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code>initialData</code> ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë²„ì—ì„œ fetchí•œ ë°ì´í„° ì‚¬ìš©í•˜ê¸°</h2>\n<p>React Queryì˜ <code>prefetching</code>ê³¼ <code>dehydrate</code>/<code>hydrate</code> APIë¥¼ ì „í˜€ ì‚¬ìš©í•˜ì§€ ì•Šê³ , useQueryì— raw ë°ì´í„°ë¥¼ <code>initialData</code> ì˜µì…˜ìœ¼ë¡œ ì „ë‹¬í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì´ ë°©ë²•ì„ ì´ìš©í•´ì„œë„ ì„œë²„ì—ì„œ ë¯¸ë¦¬ ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë°ìš”, ì–´ë–¤ ë¬¸ì œì ì´ ìˆê³  ì™œ Hydration APIê°€ ë‚˜ì˜¤ê²Œ ë˜ì—ˆëŠ”ì§€ ì‚´í´ë´…ì‹œë‹¤. Next.jsì—ì„œ React-Queryë¥¼ ì‚¬ìš©í•œë‹¤ê³  ê°€ì •í•´ ë´…ë‹ˆë‹¤.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Next.js í˜ì´ì§€ ë¼ìš°í„° ì˜ˆì‹œ</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk4\">async</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">getServerSideProps</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">posts</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk11\">getPosts</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">props:</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">posts</span><span class=\"mtk1\"> } }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">Posts</span><span class=\"mtk1\">(</span><span class=\"mtk12\">props</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">data</span><span class=\"mtk1\"> } = </span><span class=\"mtk11\">useQuery</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">queryKey:</span><span class=\"mtk1\"> [</span><span class=\"mtk8\">&#39;posts&#39;</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">queryFn:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">getPosts</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">initialData:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">props</span><span class=\"mtk1\">.</span><span class=\"mtk12\">posts</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p><code>getStaticProps</code>ë‚˜ ì´ì „ì˜ <code>getInitialProps</code>ì—ì„œë„ ì˜ ì‘ë™í•©ë‹ˆë‹¤. ì´ ë°©ë²•ì€ ì„¤ì •ì€ ìµœì†Œí•œìœ¼ë¡œ í•˜ê³ , ì¼ë¶€ ê²½ìš°ì—ëŠ” ë¹ ë¥¸ í•´ê²°ì±…ì´ ë  ìˆ˜ ìˆì§€ë§Œ, ì „ì²´ ì ‘ê·¼ë²•ì— ë¹„í•´ ê³ ë ¤í•´ì•¼ í•  ëª‡ ê°€ì§€ tradeoffê°€ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ì°¸ê³ : ì—¬ê¸°ì„œëŠ” React Queryë¥¼ ì‚¬ìš©í•˜ë˜, ë°ì´í„°ë¥¼ ì‚¬ì „ì— ê°€ì ¸ì˜¤ê¸° ìœ„í•´ <code>initialData</code> ì˜µì…˜ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ë¥¼ ì´ì•¼ê¸°í•˜ê³  ìˆìŒ.*</p>\n<ul>\n<li>íŠ¸ë¦¬ ë§¤ìš° ì•„ë˜ìª½ì— ìˆëŠ” ì»´í¬ë„ŒíŠ¸ì—ì„œ <code>useQuery</code>ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²½ìš°, <code>initialData</code>ë¥¼ ê·¸ ì§€ì ê¹Œì§€ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤.</li>\n<li>ì—¬ëŸ¬ ìœ„ì¹˜ì—ì„œ ë™ì¼í•œ ì¿¼ë¦¬ë¡œ <code>useQuery</code>ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²½ìš°, <code>initialData</code>ë¥¼ í•˜ë‚˜ì—ë§Œ ì „ë‹¬í•˜ëŠ” ê²ƒì€ ì•±ì´ ë³€ê²½ë  ë•Œ ì·¨ì•½í•˜ê³  ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <code>initialData</code>ì™€ í•¨ê»˜ <code>useQuery</code>ë¥¼ ê°€ì§„ ì»´í¬ë„ŒíŠ¸ë¥¼ ì œê±°í•˜ê±°ë‚˜ ì´ë™í•˜ë©´, ì»´í¬ë„ŒíŠ¸ê°€ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì— ê¹Šìˆ™ì´ ìœ„ì¹˜í•˜ê³  ìˆê³ , ì´ëŸ° êµ¬ì¡°ì—ì„œ <code>useQuery</code>ë¥¼ ì‚¬ìš©í•œë‹¤ë©´, <em>(ìƒìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì œê³µë˜ëŠ” <code>initialData</code>ê°€ ì¤‘ì²©ëœ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì˜ <code>useQuery</code>ì— ì˜¬ë°”ë¥´ê²Œ ì „ë‹¬ë˜ì§€ ì•Šì•„ì„œ)</em> ë” ì´ìƒ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ìˆì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•„ìš”í•œ ëª¨ë“  ì¿¼ë¦¬ì— <code>initialData</code>ë¥¼ ì „ë‹¬í•˜ëŠ” ê²ƒë„ ë²ˆê±°ë¡œìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>\n<li>ì„œë²„ì—ì„œ ì¿¼ë¦¬ê°€ ì–¸ì œ fetch ë˜ì—ˆëŠ”ì§€ ì•Œ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, <code>dataUpdatedAt</code>ì™€ ì¿¼ë¦¬ì˜ refetching ì—¬ë¶€ëŠ” í˜ì´ì§€ê°€ ë¡œë“œëœ ì‹œì ì— ë”°ë¼ ê²°ì •ë©ë‹ˆë‹¤.</li>\n<li>ì¿¼ë¦¬ì— ëŒ€í•œ ë°ì´í„°ê°€ ìºì‹œì— ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ë„, <code>initialData</code>ëŠ” ì´ ë°ì´í„°ë¥¼ ê²°ì½” ë®ì–´ì“°ì§€ ì•ŠìŠµë‹ˆë‹¤. ì‹¬ì§€ì–´ ìƒˆ ë°ì´í„°ê°€ ê¸°ì¡´ ë°ì´í„°ë³´ë‹¤ ì‹ ì„ í•˜ë”ë¼ë„ ë§ì…ë‹ˆë‹¤.\n<ul>\n<li>ì™œ íŠ¹íˆ ë” ë‚˜ìœì§€ë¥¼ ì´í•´í•˜ë ¤ë©´, ìœ„ì˜ <code>getServerSideProps</code> ì˜ˆë¥¼ ê³ ë ¤í•´ ë³´ì„¸ìš”. í˜ì´ì§€ë¥¼ ì—¬ëŸ¬ ë²ˆ ì™”ë‹¤ ê°”ë‹¤ í•˜ë©´, ë§¤ë²ˆ <code>getServerSideProps</code>ê°€ í˜¸ì¶œë˜ì–´ ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ì§€ë§Œ, <code>initialData</code> ì˜µì…˜ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— í´ë¼ì´ì–¸íŠ¸ ìºì‹œì™€ ë°ì´í„°ëŠ” ê²°ì½” ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</li>\n</ul>\n</li>\n</ul>\n<p>ì´ëŸ¬í•œ ë‹¨ì ì€ Hydration APIë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ê²°í•  ìˆ˜ ìˆê³ , ì„¤ì • ë˜í•œ ë”ìš± ê°„ë‹¨í•©ë‹ˆë‹¤.</p>\n<h2 id=\"hydration-api-ì‚¬ìš©í•˜ê¸°\" style=\"position:relative;\"><a href=\"#hydration-api-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"hydration api ì‚¬ìš©í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://tanstack.com/query/v5/docs/react/guides/ssr#using-the-hydration-apis\">Hydration API</a> ì‚¬ìš©í•˜ê¸°</h2>\n<p>React Queryì—ì„œëŠ” <code>dehydrate</code>ì™€ <code>hydrate</code> í•¨ìˆ˜ë¥¼ ì œê³µí•˜ì—¬ ì´ ê³¼ì •ì„ ê°„ì†Œí™”í•©ë‹ˆë‹¤. ê° APIì˜ ì—­í• ê³¼ ì‚¬ìš©ë°©ë²• ê·¸ë¦¬ê³  ê³µì‹ ë¬¸ì„œ ì˜ˆì‹œì— ëŒ€í•´ì„œ ì•Œì•„ë³´ë„ë¡ í•©ì‹œë‹¤.</p>\n<h3 id=\"hydrateì™€-dehydrateì˜-ì—­í• \" style=\"position:relative;\"><a href=\"#hydrate%EC%99%80-dehydrate%EC%9D%98-%EC%97%AD%ED%95%A0\" aria-label=\"hydrateì™€ dehydrateì˜ ì—­í•  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hydrateì™€ Dehydrateì˜ ì—­í• </h3>\n<ul>\n<li><code>dehydrate</code>ëŠ” ì„œë²„ì—ì„œ React Queryì˜ ìƒíƒœë¥¼ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ì†¡í•  ìˆ˜ ìˆëŠ” í˜•íƒœë¡œ ë§Œë“¤ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤. ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ í›„, ì´ ë°ì´í„°ë¥¼ ì§ë ¬í™”(serialization) í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ì†¡í•©ë‹ˆë‹¤. ì§ë ¬í™”ëœ ë°ì´í„°ëŠ” <code>DehydratedState</code> í˜•íƒœë¡œ í‘œí˜„ë˜ë©°, í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ <code>hydrate</code> í•¨ìˆ˜ë¥¼ í†µí•´ ë‹¤ì‹œ React Query ìƒíƒœë¡œ ë³€í™˜ë©ë‹ˆë‹¤.</li>\n<li><code>hydrate</code>ëŠ” í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ì§ë ¬í™”ëœ ìƒíƒœë¥¼ ë°›ì•„ ì´ë¥¼ React Queryì˜ ìƒíƒœë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ì´ ê³¼ì •ì€ ì„œë²„ì—ì„œ ë¯¸ë¦¬ ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ í´ë¼ì´ì–¸íŠ¸ì˜ ì¿¼ë¦¬ ìºì‹œì— ì ìš©í•˜ì—¬, ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ì—†ì´ ë°ì´í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.</li>\n</ul>\n<h3 id=\"ì‚¬ìš©ë°©ë²•\" style=\"position:relative;\"><a href=\"#%EC%82%AC%EC%9A%A9%EB%B0%A9%EB%B2%95\" aria-label=\"ì‚¬ìš©ë°©ë²• permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì‚¬ìš©ë°©ë²•</h3>\n<ol>\n<li>í”„ë ˆì„ì›Œí¬ ë¡œë” í•¨ìˆ˜ì—ì„œ <code>const queryClient = new QueryClient(options)</code>ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</li>\n<li>ì•± ë¡œë” í•¨ìˆ˜ì—ì„œ, ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê³  ì‹¶ì€ ê° ì¿¼ë¦¬ì— ëŒ€í•´ <code>await queryClient.prefetchQuery(...)</code>ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.\n<ul>\n<li>ê°€ëŠ¥í•˜ë©´ <code>await Promise.all(...)</code>ì„ ì‚¬ìš©í•´ ì¿¼ë¦¬ë“¤ì„ ë³‘ë ¬ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.</li>\n<li>ë¯¸ë¦¬ ê°€ì ¸ì˜¤ì§€ ì•Šì€ ì¿¼ë¦¬ë“¤ì´ ìˆì–´ë„ ê´œì°®ìŠµë‹ˆë‹¤. ì´ ì¿¼ë¦¬ë“¤ì€ ì„œë²„ì—ì„œ ë Œë”ë§ ë˜ì§€ ì•Šê³ , ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆê²Œ ëœ í›„ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ëŠ” ì‚¬ìš©ì ìƒí˜¸ì‘ìš© í›„ì—ë§Œ í‘œì‹œë˜ê±°ë‚˜ ë˜ëŠ” í˜ì´ì§€ í•˜ë‹¨ì— ìˆì–´ ë” ì¤‘ìš”í•œ ì½˜í…ì¸ ì˜ ë¡œë”©ì„ ë°©í•´í•˜ì§€ ì•Šê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.</li>\n</ul>\n</li>\n<li>ë¡œë”ì—ì„œ <code>dehydrate(queryClient)</code>ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. ì´ ë°˜í™˜ êµ¬ë¬¸ì˜ ì •í™•í•œ ë¬¸ë²•ì€ í”„ë ˆì„ì›Œí¬ì— ë”°ë¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>\n<li><code>&#x3C;HydrationBoundary state={dehydratedState}></code>ë¡œ íŠ¸ë¦¬ë¥¼ ê°ì‹¸ëŠ”ë°, <code>dehydratedState</code>ëŠ” í”„ë ˆì„ì›Œí¬ ë¡œë”ì—ì„œ ì˜µë‹ˆë‹¤. <code>dehydratedState</code>ë¥¼ ì–»ëŠ” ë°©ë²•ë„ í”„ë ˆì„ì›Œí¬ì— ë”°ë¼ ë‹¤ë¦…ë‹ˆë‹¤.\n<ul>\n<li>ì´ ì‘ì—…ì€ ê° ë¼ìš°íŠ¸ë§ˆë‹¤ ìˆ˜í–‰í•˜ê±°ë‚˜, ì• í”Œë¦¬ì¼€ì´ì…˜ ìµœìƒë‹¨ì—ì„œ ìˆ˜í–‰í•˜ì—¬ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ë¥¼ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"nextjsì—ì„œ-ì˜ˆì‹œ\" style=\"position:relative;\"><a href=\"#nextjs%EC%97%90%EC%84%9C-%EC%98%88%EC%8B%9C\" aria-label=\"nextjsì—ì„œ ì˜ˆì‹œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://tanstack.com/query/v5/docs/react/guides/ssr#full-nextjs-pages-router-example\">Next.jsì—ì„œ ì˜ˆì‹œ</a></h3>\n<ul>\n<li>\n<p>ì´ˆê¸° ì„¸íŒ…(ì•± ë¡œë” í•¨ìˆ˜)</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// _app.tsx</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">QueryClient</span><span class=\"mtk1\">, </span><span class=\"mtk12\">QueryClientProvider</span><span class=\"mtk1\"> } </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@tanstack/react-query&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">MyApp</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">Component</span><span class=\"mtk1\">, </span><span class=\"mtk12\">pageProps</span><span class=\"mtk1\"> }) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> [</span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\">] = </span><span class=\"mtk12\">React</span><span class=\"mtk1\">.</span><span class=\"mtk11\">useState</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    () </span><span class=\"mtk4\">=&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">QueryClient</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">defaultOptions:</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk12\">queries:</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// SSRì—ì„œëŠ” í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì¦‰ì‹œ ì¬ìš”ì²­í•˜ëŠ” ê²ƒì„ í”¼í•˜ê¸° ìœ„í•´,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// default staleTimeì„ 0ë³´ë‹¤ ë†’ê²Œ ì„¤ì •í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì…ë‹ˆë‹¤.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">staleTime:</span><span class=\"mtk1\"> </span><span class=\"mtk7\">60</span><span class=\"mtk1\"> * </span><span class=\"mtk7\">1000</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      }),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">QueryClientProvider</span><span class=\"mtk1\"> </span><span class=\"mtk12\">client</span><span class=\"mtk1\">=</span><span class=\"mtk4\">{</span><span class=\"mtk12\">queryClient</span><span class=\"mtk4\">}</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">Component</span><span class=\"mtk1\"> </span><span class=\"mtk4\">{</span><span class=\"mtk1\">...</span><span class=\"mtk12\">pageProps</span><span class=\"mtk4\">}</span><span class=\"mtk1\"> </span><span class=\"mtk17\">/&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;/</span><span class=\"mtk10\">QueryClientProvider</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n</li>\n<li>\n<p>ê° ë¼ìš°í„°ì—ì„œ</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// pages/posts.jsx</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">dehydrate</span><span class=\"mtk1\">, </span><span class=\"mtk12\">HydrationBoundary</span><span class=\"mtk1\">, </span><span class=\"mtk12\">QueryClient</span><span class=\"mtk1\">, </span><span class=\"mtk12\">useQuery</span><span class=\"mtk1\"> } </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@tanstack/react-query&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// ì´ê²ƒì€ getServerSidePropsì—ì„œë„ ë™ì¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk4\">async</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">getStaticProps</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">QueryClient</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\">.</span><span class=\"mtk11\">prefetchQuery</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">queryKey:</span><span class=\"mtk1\"> [</span><span class=\"mtk8\">&#39;posts&#39;</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">queryFn:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">getPosts</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">props:</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">dehydratedState:</span><span class=\"mtk1\"> </span><span class=\"mtk11\">dehydrate</span><span class=\"mtk1\">(</span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\">),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">Posts</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// useQueryëŠ” &lt;PostsRoute&gt;ì˜ ë” ê¹Šì€ ìì‹ì—ì„œë„ ë§ˆì°¬ê°€ì§€ë¡œ ì‚¬ìš©ë  ìˆ˜ ìˆìœ¼ë©°,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// ì–´ëŠ ë°©ì‹ì´ë“  ë°ì´í„°ëŠ” ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">data</span><span class=\"mtk1\"> } = </span><span class=\"mtk11\">useQuery</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">queryKey:</span><span class=\"mtk1\"> [</span><span class=\"mtk8\">&#39;posts&#39;</span><span class=\"mtk1\">], </span><span class=\"mtk12\">queryFn:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">getPosts</span><span class=\"mtk1\"> })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// ì´ ì¿¼ë¦¬ëŠ” ì„œë²„ì—ì„œ ë¯¸ë¦¬ ê°€ì ¸ì˜¤ì§€ ì•Šì•˜ìœ¼ë©°, í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì‹œì‘ë  ë•Œê¹Œì§€ ìš”ì²­í•˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// ì´ ë‘ ê°€ì§€ íŒ¨í„´ì„ í˜¼í•©í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">data</span><span class=\"mtk1\">: </span><span class=\"mtk12\">commentsData</span><span class=\"mtk1\"> } = </span><span class=\"mtk11\">useQuery</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">queryKey:</span><span class=\"mtk1\"> [</span><span class=\"mtk8\">&#39;posts-comments&#39;</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">queryFn:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">getComments</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// ...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk11\">PostsRoute</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">dehydratedState</span><span class=\"mtk1\"> }) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">return</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk12\">HydrationBoundary</span><span class=\"mtk1\"> </span><span class=\"mtk12\">state</span><span class=\"mtk1\">={</span><span class=\"mtk12\">dehydratedState</span><span class=\"mtk1\">}&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      &lt;</span><span class=\"mtk12\">Posts</span><span class=\"mtk1\"> /&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;/</span><span class=\"mtk12\">HydrationBoundary</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n</li>\n<li>\n<p>íŒ1) ë³´ì¼ëŸ¬ í”Œë ˆì´íŠ¸ë¥¼ ì—†ì• ê¸° ìœ„í•œ ì˜ˆì‹œ</p>\n<ul>\n<li>\n<p>ëª¨ë“  ë¼ìš°íŠ¸ì— ì´ ë¶€ë¶„ì„ í¬í•¨í•˜ëŠ” ê²ƒì€ ìƒë‹¹í•œ ë³´ì¼ëŸ¬ í”Œë ˆì´íŠ¸ì²˜ëŸ¼ ë³´ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë°©ë²•ì— ë¬¸ì œê°€ ìˆëŠ” ê²ƒì€ ì•„ë‹ˆì§€ë§Œ, ì´ ë³´ì¼ëŸ¬ í”Œë ˆì´íŠ¸ë¥¼ ì œê±°í•˜ê³  ì‹¶ë‹¤ë©´, Next.jsì—ì„œ ì„¤ì •ì„ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n</li>\n<li>\n<p>AS-IS (ë³´ì¼ëŸ¬ í”Œë ˆì´íŠ¸ ì—†ì• ê¸° ì „)</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk11\">PostsRoute</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">dehydratedState</span><span class=\"mtk1\"> }) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">return</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;</span><span class=\"mtk12\">HydrationBoundary</span><span class=\"mtk1\"> </span><span class=\"mtk12\">state</span><span class=\"mtk1\">={</span><span class=\"mtk12\">dehydratedState</span><span class=\"mtk1\">}&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      &lt;</span><span class=\"mtk12\">Posts</span><span class=\"mtk1\"> /&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;/</span><span class=\"mtk12\">HydrationBoundary</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n</li>\n<li>\n<p>TO-BE (ë³´ì¼ëŸ¬ í”Œë ˆì´íŠ¸ ì—†ì•¤ í›„)</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// _app.tsx</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">HydrationBoundary</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">QueryClient</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">QueryClientProvider</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">} </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;@tanstack/react-query&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">MyApp</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">Component</span><span class=\"mtk1\">, </span><span class=\"mtk12\">pageProps</span><span class=\"mtk1\"> }) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> [</span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\">] = </span><span class=\"mtk12\">React</span><span class=\"mtk1\">.</span><span class=\"mtk11\">useState</span><span class=\"mtk1\">(() </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">QueryClient</span><span class=\"mtk1\">())</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">QueryClientProvider</span><span class=\"mtk1\"> </span><span class=\"mtk12\">client</span><span class=\"mtk1\">=</span><span class=\"mtk4\">{</span><span class=\"mtk12\">queryClient</span><span class=\"mtk4\">}</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">HydrationBoundary</span><span class=\"mtk1\"> </span><span class=\"mtk12\">state</span><span class=\"mtk1\">=</span><span class=\"mtk4\">{</span><span class=\"mtk12\">pageProps</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dehydratedState</span><span class=\"mtk4\">}</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk17\">&lt;</span><span class=\"mtk10\">Component</span><span class=\"mtk1\"> </span><span class=\"mtk4\">{</span><span class=\"mtk1\">...</span><span class=\"mtk12\">pageProps</span><span class=\"mtk4\">}</span><span class=\"mtk1\"> </span><span class=\"mtk17\">/&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk17\">&lt;/</span><span class=\"mtk10\">HydrationBoundary</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;/</span><span class=\"mtk10\">QueryClientProvider</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// pages/posts.tsx</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// HydrationBoundaryë¥¼ í¬í•¨í•œ PostsRouteë¥¼ ì œê±°í•˜ê³  ëŒ€ì‹  Postsë¥¼ ì§ì ‘ ë‚´ë³´ëƒ…ë‹ˆë‹¤:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">Posts</span><span class=\"mtk1\">() { ... }</span></span></span></code></pre>\n</li>\n<li>\n<p>íŒ2) ì„œë²„ì—ì„œ ì¡°ê±´ë¶€ prefetch í•˜ëŠ” ë°©ë²•</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk4\">async</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">getServerSideProps</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">QueryClient</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">user</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\">.</span><span class=\"mtk11\">fetchQuery</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">queryKey:</span><span class=\"mtk1\"> [</span><span class=\"mtk8\">&#39;user&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">email</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">queryFn:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">getUserByEmail</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">user</span><span class=\"mtk1\">?.</span><span class=\"mtk12\">userId</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">await</span><span class=\"mtk1\"> </span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\">.</span><span class=\"mtk11\">prefetchQuery</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">queryKey:</span><span class=\"mtk1\"> [</span><span class=\"mtk8\">&#39;projects&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">userId</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">queryFn:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">getProjectsByUser</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">props:</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">dehydratedState:</span><span class=\"mtk1\"> </span><span class=\"mtk11\">dehydrate</span><span class=\"mtk1\">(</span><span class=\"mtk12\">queryClient</span><span class=\"mtk1\">) } }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<ul>\n<li>\n<p>ì°¸ê³  - í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì¡°ê±´ë¶€ fetch í•˜ëŠ”ë²• (<code>enabled</code> ì´ìš©í•˜ê¸°)</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// ì‚¬ìš©ì ê°€ì ¸ì˜¤ê¸°</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">data</span><span class=\"mtk1\">: </span><span class=\"mtk12\">user</span><span class=\"mtk1\"> } = </span><span class=\"mtk11\">useQuery</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">queryKey:</span><span class=\"mtk1\"> [</span><span class=\"mtk8\">&#39;user&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">email</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">queryFn:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">getUserByEmail</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">userId</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">user</span><span class=\"mtk1\">?.</span><span class=\"mtk12\">id</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// ê·¸ ë‹¤ìŒ ì‚¬ìš©ìì˜ í”„ë¡œì íŠ¸ ê°€ì ¸ì˜¤ê¸°</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">status</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">fetchStatus</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">data</span><span class=\"mtk1\">: </span><span class=\"mtk12\">projects</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">} = </span><span class=\"mtk11\">useQuery</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">queryKey:</span><span class=\"mtk1\"> [</span><span class=\"mtk8\">&#39;projects&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">userId</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">queryFn:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">getProjectsByUser</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// userIdê°€ ì¡´ì¬í•  ë•Œê¹Œì§€ ì¿¼ë¦¬ëŠ” ì‹¤í–‰ë˜ì§€ ì•ŠìŒ</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">enabled:</span><span class=\"mtk1\"> !!</span><span class=\"mtk12\">userId</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">})</span></span></span></code></pre>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"ê¸°íƒ€-ì°¸ê³ ì‚¬í•­\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%ED%83%80-%EC%B0%B8%EA%B3%A0%EC%82%AC%ED%95%AD\" aria-label=\"ê¸°íƒ€ ì°¸ê³ ì‚¬í•­ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê¸°íƒ€ ì°¸ê³ ì‚¬í•­</h2>\n<ul>\n<li>ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ ê°„ ì‹œê°„ ë™ê¸°í™”: <code>staleTime</code> ì„¤ì •ì€ ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ ì‹œì ì„ ê¸°ì¤€ìœ¼ë¡œ í•©ë‹ˆë‹¤. ì„œë²„ì˜ ì‹œê°„ ì„¤ì •ì´ ì •í™•í•´ì•¼ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•©ë‹ˆë‹¤.</li>\n<li>ë©”ëª¨ë¦¬ ê´€ë¦¬: ê° ìš”ì²­ë§ˆë‹¤ ìƒˆë¡œìš´ <code>QueryClient</code>ë¥¼ ìƒì„±í•˜ëŠ” ê²½ìš°, ì„œë²„ì˜ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ì¦ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì ì ˆí•œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.</li>\n<li>ì½”ë“œ ë¶„í• ê³¼ ìš”ì²­ ì›Œí„°í´: ì½”ë“œ ë¶„í• ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì½”ë“œë¥¼ ë©”ì¸ ë²ˆë“¤ì— í¬í•¨ì‹œí‚¬ì§€, ì½”ë“œ ë¶„í• ëœ ë²ˆë“¤ì— ë„£ì„ì§€ ê²°ì •í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” ì„±ëŠ¥ê³¼ ìš”ì²­ ì›Œí„°í´ì— ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤.</li>\n</ul>\n<h2 id=\"ê²°ë¡ \" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EB%A1%A0\" aria-label=\"ê²°ë¡  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê²°ë¡ </h2>\n<p>React Queryì˜ <code>hydrate</code>ì™€ <code>dehydrate</code>ëŠ” ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ì„ êµ¬í˜„í•˜ëŠ” ë° ìˆì–´ í•„ìˆ˜ì ì¸ ë„êµ¬ì…ë‹ˆë‹¤. ì´ë“¤ì€ ë°ì´í„°ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì „ë‹¬í•˜ê³ , ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„±ëŠ¥ì„ ìµœì í™”í•˜ëŠ” ë° ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ ê¸°ëŠ¥ë“¤ì„ ì‚¬ìš©í•  ë•ŒëŠ” ë°ì´í„°ì˜ í•„ìš”ì„±, ë„¤íŠ¸ì›Œí¬ ì˜¤ë²„í—¤ë“œ, ê·¸ë¦¬ê³  ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ ê°„ì˜ ì¼ê´€ì„±ì„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ íš¨ìœ¨ì ì´ê³  ì‚¬ìš©ì ì¹œí™”ì ì¸ SSR ê²½í—˜ì„ êµ¬ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .default-dark .mtk1 { color: #D4D4D4; }\n  .default-dark .mtk3 { color: #6A9955; }\n  .default-dark .mtk15 { color: #C586C0; }\n  .default-dark .mtk4 { color: #569CD6; }\n  .default-dark .mtk11 { color: #DCDCAA; }\n  .default-dark .mtk12 { color: #9CDCFE; }\n  .default-dark .mtk8 { color: #CE9178; }\n  .default-dark .mtk10 { color: #4EC9B0; }\n  .default-dark .mtk7 { color: #B5CEA8; }\n  .default-dark .mtk17 { color: #808080; }\n  .default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","frontmatter":{"date":"December 10, 2023","title":"[React-Query] ì„œë²„ì—ì„œ prefetching í•œ ë°ì´í„° ì‚¬ìš©í•˜ê¸°","categories":"react","author":"soobing"},"fields":{"slug":"/react/server-rendering-and-react-query/"}},"prev":null,"site":{"siteMetadata":{"siteUrl":"https://soobing.github.io","comments":{"utterances":{"repo":"soobing/soobing.github.io"}}}}},"pageContext":{"slug":"/react/next-app-router-react-query/","nextSlug":"/react/server-rendering-and-react-query/","prevSlug":""}},
    "staticQueryHashes": ["1073350324","2938748437"]}