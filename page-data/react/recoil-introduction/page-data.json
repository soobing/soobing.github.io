{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/react/recoil-introduction/",
    "result": {"data":{"cur":{"id":"08e40669-d8eb-531c-ab48-fcad02ba39ef","html":"<p>React 18로 버전업 하면서 프로젝트에 Recoil을 도입했는데, 그 과정에서 고민했던 내용을 기록차 남겨본다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACgUlEQVQoz22SS2sTARSF81NcuXSh4kaK4EYr4kJFdOuiiqjgQoSCqFQFceGqCxVBQRBaBF/V2ja179ok5tE2TeMkNdN0JjOZTJN5JZlJMp8kbX2gFy6XC4ePcy430Gr5hOMasSWdRHKTbM6kuKBQiKikFlQWF1SiyzqJzCYzayW+SUVGZJmwKjFWFNBqFu3yfb8zA22gZXvYtoem17CqDYpJDSmmkEuVScVLzEc0VvObDK2uE5EUhnMic0qON/klqg33byD/KUd3KOdNpGSJbMYkKxiEfigktSIRqUBMkfmqiCzrckff2ob5+ARqtTrlioFtO5iWjVExUbIqRbXCypxIMioTWhYJxrLMZ0SmsgLjwiqqZSIYWgfUbLVobXeg2WxSLld+WW64TRzNxtRdNvI20dksk0sCMwmJeL7IbCHHml5GKMiky8o/6TqRXdfFsuwtYL2BWbAQMzoZQWdRlJmJCCwsrzO6mEayTErVOt/1EmlVIpSM8CkyzsjkB4a/vCew48xxqnieh9/0EcMbvHoc5/nnKP3RbwwnUgyMzzH2Mc/gRJRJIc07YRWhUmQsFOTe7StcON1N3+XzW8AO1IdavYZTsom9TvPoQZybAyFuTY/Sn54mHEwy0LfIgydRet9+4e70CGFdZGRqiBtHunh69jjPrl7airzjsuW3MEoGckJjIigzsaISXM8SNzZwFJvZFxkGB/P0T6Z4thIhbsjcvHOfEycvcqr7DPv2HPgdeWd27mlbVKs13Hodx9maXsPD9Vxsu4rjOJQNs6O93vuQg9097OrqYff+o387/BPa7rrr4rner7194/ZXtN9jR3vv0UuOnbnG7sOX2XvoHD8BCyEP5FdvRw4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"atoms\"\n        title=\"atoms\"\n        src=\"/static/bacfc19ebc3abbd16907982695c8d6b5/37523/atoms.png\"\n        srcset=\"/static/bacfc19ebc3abbd16907982695c8d6b5/e9ff0/atoms.png 180w,\n/static/bacfc19ebc3abbd16907982695c8d6b5/f21e7/atoms.png 360w,\n/static/bacfc19ebc3abbd16907982695c8d6b5/37523/atoms.png 720w,\n/static/bacfc19ebc3abbd16907982695c8d6b5/302a4/atoms.png 1080w,\n/static/bacfc19ebc3abbd16907982695c8d6b5/21b4d/atoms.png 1280w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"tldr\" style=\"position:relative;\"><a href=\"#tldr\" aria-label=\"tldr permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TL;DR;</h2>\n<p>개념 정리나 장단점 비교에 대해서는 이미 알고 계신분들도 있을 것 같아서 폴더구조나 Redux를 대체하는게 맞는가에 대해서만 먼저 간단하게 요약한 내용을 공유한다.</p>\n<h3 id=\"1-폴더-구조는-data-source-별로-나누자\" style=\"position:relative;\"><a href=\"#1-%ED%8F%B4%EB%8D%94-%EA%B5%AC%EC%A1%B0%EB%8A%94-data-source-%EB%B3%84%EB%A1%9C-%EB%82%98%EB%88%84%EC%9E%90\" aria-label=\"1 폴더 구조는 data source 별로 나누자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 폴더 구조는 data source 별로 나누자</h3>\n<ul>\n<li><a href=\"https://github.com/facebookexperimental/Recoil/issues/27\">Suggested folder structure for atoms and selectors</a>\n<ul>\n<li><code>recoil</code> 폴더 하위에 <code>data source</code> 별로 나누자</li>\n<li><code>data source</code> 하위에 <code>atoms, selectors, hooks</code>를 두자</li>\n</ul>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">├── App.tsx</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">├── index.tsx</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">└── src</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    ├── components</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    │   └── TodoItem.tsx</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    └── recoil</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        |── todo</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            └── atoms.ts</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            └── selectors.ts</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            └── useTodo.ts</span></span></code></pre>\n</li>\n</ul>\n<h3 id=\"2-concurrency-mode-사용하려면-redux는-버리고-recoil로-넘어가야하나\" style=\"position:relative;\"><a href=\"#2-concurrency-mode-%EC%82%AC%EC%9A%A9%ED%95%98%EB%A0%A4%EB%A9%B4-redux%EB%8A%94-%EB%B2%84%EB%A6%AC%EA%B3%A0-recoil%EB%A1%9C-%EB%84%98%EC%96%B4%EA%B0%80%EC%95%BC%ED%95%98%EB%82%98\" aria-label=\"2 concurrency mode 사용하려면 redux는 버리고 recoil로 넘어가야하나 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. concurrency mode 사용하려면 Redux는 버리고 Recoil로 넘어가야하나?</h3>\n<ul>\n<li><a href=\"https://github.com/reactwg/react-18/discussions/86\">useSyncExternalStore</a> hook 을 사용해서 Redux에서도 동시성 모드를 사용할 수 있다.</li>\n<li>이 부분에 대해서 고민해 본 내용은 아래에..</li>\n</ul>\n<h2 id=\"recoil-도입-배경\" style=\"position:relative;\"><a href=\"#recoil-%EB%8F%84%EC%9E%85-%EB%B0%B0%EA%B2%BD\" aria-label=\"recoil 도입 배경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recoil 도입 배경</h2>\n<p>Recoil은 Facebook에서 개발한 상태 관리 라이브러리다. 이전에는 Facebook에서 React 애플리케이션의 상태 관리를 위해 <a href=\"https://github.com/facebookarchive/flux\">Flux 아키텍처</a>를 구현한 Redux, MobX와 같은 라이브러리를 사용했었다. (사실 아직도 사용하는 곳이 많음) 그러나 아래 표를 보면 알겠지만, Flux 아키텍처를 구현하기위해서 복잡하고 번거로운 코드를 작성해야하므로 Facebook은 더 간편하고 직관적인 상태 관리 라이브러리를 고민하게 됬다고 한다.</p>\n<ul>\n<li>번거로운 코드?\n<ul>\n<li>Redux를 예시로 설명하면 애플리케이션의 상태를 하나의 객체로 관리하고, 상태 변경을 발생시키는 액션(Action)과 상태 변경을 처리하는 리듀서(Reducer)를 사용하여 데이터를 관리하므로 이와 관련된 코드들이 추가적으로 필요하다.</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB20lEQVQoz42PTU8TURSGZ+nvcOHGHyALja4MIZEViQtiiDFqFEGiEXWrmGAkmugGU0KhpRFjwFJpbRuS2lKt05aRjm2pWmnptzNtofNx56P33mMQywqiz+rkJOc878vA4VBKAQAhxHFcPBaLsmy1UtnfAwBDCMWYYEwopZRQggluYwBQ0ynRYTe+8l+SqfN9fRf6+8/19FimrLpcXvOO8cHnOmoxBxoBQK/VhNWQVio1W633Ho/f53vncmW+/dDVeib+JptYbhuI2czlA8FwKBxRNTWXrgSXuE+ehKLoZn5z5+OqHP2MVfVvh72nivh9bT6f9hLcZqas9otXhgYuDSazGcdT//DZiZHuiWS6vG2frt64Vrp1UytsEQBzFx0Acvzi7N0j8w+PSs0iw0bjlmmbddYhNOp8JGt/4l6YXBEbsrzOFebmqs63piR1zAQAtmsbrPPOun/c0CQG/gMFGbWG3JQQAJgY/xTKxcYvSilDO3R6UUx2Z3d447Et8OxVSFLQo5nA6UFL7+iMrJBwKnDqflfvWHdJLB5gJn+OLU524MHrq+ML1frO7ReersuTZ66/FJrGSsJ3fOjYyXsnCsLWP2LvJYrweZs75vzAm21al0QXu+TnvJqBfgOAkP9oPAI3lQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"flux\"\n        title=\"flux\"\n        src=\"/static/4e61d149ddd7fd2414a0838c10bbc1d9/37523/flux.png\"\n        srcset=\"/static/4e61d149ddd7fd2414a0838c10bbc1d9/e9ff0/flux.png 180w,\n/static/4e61d149ddd7fd2414a0838c10bbc1d9/f21e7/flux.png 360w,\n/static/4e61d149ddd7fd2414a0838c10bbc1d9/37523/flux.png 720w,\n/static/4e61d149ddd7fd2414a0838c10bbc1d9/302a4/flux.png 1080w,\n/static/4e61d149ddd7fd2414a0838c10bbc1d9/07a9c/flux.png 1440w,\n/static/4e61d149ddd7fd2414a0838c10bbc1d9/82747/flux.png 2232w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Recoil은 React의 Hook 기능을 사용하여 상태를 관리하므로 코드를 간결하고 직관적으로 작성할 수 있다. 또한, 상태의 종속성 관계를 자동으로 추적하고 캐싱하여 상태 변경이 발생할 때 효율적인 업데이트를 수행할 수 있다. 이러한 이유로 Recoil은 React 애플리케이션에서 Global 상태 관리를 위한 매우 간편하고 유연한 도구로 인기를 얻고 있다.</p>\n<h2 id=\"recoil-장단점\" style=\"position:relative;\"><a href=\"#recoil-%EC%9E%A5%EB%8B%A8%EC%A0%90\" aria-label=\"recoil 장단점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recoil 장단점</h2>\n<h3 id=\"장점\" style=\"position:relative;\"><a href=\"#%EC%9E%A5%EC%A0%90\" aria-label=\"장점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>장점</h3>\n<ol>\n<li>편리한 비동기 처리\n<ul>\n<li>비동기 처리를 위한 복잡한 중간 처리기 작성 필요 없음\n<ul>\n<li>보통 redux-thunk, redux-saga, redux-observable 등의 별도의 라이브러리를 이용하여 복잡한 중간 처리기를 작성해야 했지만, Recoil에서는 이러한 복잡한 작업을 하지 않아도 된다.</li>\n</ul>\n</li>\n<li>비동기 데이터 흐름 제어 용이\n<ul>\n<li>useRecoilState나 useRecoilValue등의 API를 사용하여 비동기 데이터를 상태로 관리하면서도 간단하게 데이터 흐름을 제어할 수 있다.</li>\n</ul>\n</li>\n<li>Async/await 문법 사용 가능:\n<ul>\n<li>비동기 처리시 async/await 문법을 사용할 수 있다.</li>\n<li>redux-saga 에서는 generate로 비동기 처리 코드를 작성해야 하는데, 이와 비교해보면 코드의 가독성과 편리성이 훨씬 높다.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>유연한 상태 관리\n<ul>\n<li>atom, selector, atomFamily, selectorFamily API를 통해 쉽게 상태를 정의하고 읽고 쓸 수 있음\n<ul>\n<li>-Family: 매개변수로 파라메터 전달</li>\n</ul>\n</li>\n<li>상태 관리의 대상이 되는 컴포넌트를 명시적으로 지정할 필요 없음\n<ul>\n<li>Redux 7.1 버전 이전에는는 컴포넌트가 Redux store의 상태 값을 사용하기 위해 connect 함수를 사용하여 컴포넌트와 상태 값을 연결해주어야 했다. 그러나 이후버전 부터는 Redux에서도 <strong><code>useSelector</code>, <code>useDispatch</code></strong> 와 같은 hook을 제공</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>DevTools 지원\n<ul>\n<li>애플리케이션의 상태 변화 디버깅 가능</li>\n</ul>\n</li>\n<li>성능\n<ul>\n<li>Recoil은 Concurrency Mode를 통해 <strong>동시성 처리를 지원</strong></li>\n<li>특정 상태의 변경이 발생할 때 해당 상태를 사용하는 컴포넌트들만 다시 렌더링되도록 최적화</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"단점\" style=\"position:relative;\"><a href=\"#%EB%8B%A8%EC%A0%90\" aria-label=\"단점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>단점</h3>\n<ol>\n<li>상태 관리 패턴의 변경\n<ul>\n<li>Redux와 같은 상태 관리 라이브러리에서의 경험을 적용할 수 없으므로 러닝커브 존재</li>\n</ul>\n</li>\n<li>문서와 커뮤니티\n<ul>\n<li>Recoil은 비교적 최신 라이브러리 이므로 문서와 커뮤니티의 규모가 Redux 보다 작다.</li>\n</ul>\n</li>\n<li>다른 라이브러리와의 호환성\n<ul>\n<li>Recoil은 React와 함께 사용하기 위한 라이브러리이므로, 다른 라이브러리와 함께 사용하는 경우 호환성 문제가 발생할 수 있음.</li>\n</ul>\n</li>\n<li>상태 변화 추적\n<ul>\n<li>Recoil은 Atom과 selector에서만 상태 변화 추적을 지원하므로, 기존의 React 컴포넌트에서 상태 변화를 추적하는 것과 다른 방식으로 접근해야 할 수 있다.</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"recoil은-concurrency-mode를-지원한다고-하는데-그렇다면-redux는-버려야하나\" style=\"position:relative;\"><a href=\"#recoil%EC%9D%80-concurrency-mode%EB%A5%BC-%EC%A7%80%EC%9B%90%ED%95%9C%EB%8B%A4%EA%B3%A0-%ED%95%98%EB%8A%94%EB%8D%B0-%EA%B7%B8%EB%A0%87%EB%8B%A4%EB%A9%B4-redux%EB%8A%94-%EB%B2%84%EB%A0%A4%EC%95%BC%ED%95%98%EB%82%98\" aria-label=\"recoil은 concurrency mode를 지원한다고 하는데 그렇다면 redux는 버려야하나 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recoil은 concurrency mode를 지원한다고 하는데, 그렇다면 Redux는 버려야하나?</h2>\n<ul>\n<li>\n<p><a href=\"https://github.com/reactwg/react-18/discussions/86\">useSyncExternalStore</a> hook 사용하면 Redux를 사용하면서 concurrency mode를 사용할 수 있다.</p>\n<ul>\n<li><code>Redux + useSyncExternalStore</code> 관련 자료\n<ul>\n<li><a href=\"https://github.com/reactwg/react-18/discussions/86\">useMutableSource → useSyncExternalStore #86</a></li>\n<li><a href=\"https://dev.to/sebastienlorber/react-18-milestone-react-redux-adopts-usesyncexternalstore-102b\">React 18 milestone: React-Redux adopts useSyncExternalStore</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>그렇지만, useSyncExternalStore를 사용한다고 state 변경시 update 일어나는 로직이 Recoil과 동일하지는 않다.</p>\n<ul>\n<li>Redux + useSyncExternalStore 훅을 사용하는 경우, Redux의 상태 업데이트가 완료되는 시점에서 React의 렌더링이 일어나지만,</li>\n<li>Recoil은 내부적으로 React의 상태 감지 기능을 사용하여 상태 업데이트가 발생하면 즉시 React의 렌더링을 트리거한다.</li>\n<li>성능 차이는 미미하겠지만 정확히 이야기하면 Recoil은 Redux보다 더 빠른 상태 업데이트와 더 높은 성능을 제공할 수 있다.</li>\n</ul>\n</li>\n<li>\n<p>추가적으로, concurrency mode 이외에도 Redux와 Recoil는 차이점이 존재한다.</p>\n<p>위에서 비교한 장단점 코너와 중복되는 이야기가 많으므로 간략하게만 이야기하면..</p>\n<ul>\n<li>Redux의 flux 패턴은 Recoil의 atom/select 패턴과 비교했을때 추가적인 코드가 더 많이 필요</li>\n<li>Redux는 비동기 데이터 흐름을 제어하기 위한 API를 제공하지 않는다. → redux-saga와 같은  middleware를 사용해야 한다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"내-생각\" style=\"position:relative;\"><a href=\"#%EB%82%B4-%EC%83%9D%EA%B0%81\" aria-label=\"내 생각 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>내 생각</h3>\n<ul>\n<li>신규 프로젝트이고 React 18을 사용한다면 Recoil을 한번 사용해보는 것을 추천한다.</li>\n<li>기존 프로젝트에서 이미 Redux를 사용중이고 React 18 버전을 사용한다면, useSyncExternalStore를 사용하여 concurrency mode를 함께 사용해보면 좋을 것 같다.</li>\n</ul>\n<h2 id=\"개념정리\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EB%85%90%EC%A0%95%EB%A6%AC\" aria-label=\"개념정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개념정리</h2>\n<p>정확한 개념은 <a href=\"https://recoiljs.org/ko/docs/introduction/motivation/\">공식문서</a>를 참고하도록 하자. 간략하게 전반적인 개념정리를 하기 위한 코너.</p>\n<h3 id=\"state\" style=\"position:relative;\"><a href=\"#state\" aria-label=\"state permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>State</h3>\n<ul>\n<li>Atom, Selector\n<ul>\n<li>Atom: 가장 작은 state 단위</li>\n<li>Selector: 파생된 state. atoms나 다른 selectors를 입력으로 받아들이는 순수 함수(pure function)</li>\n<li>key값 (전역적으로) 고유해야함</li>\n</ul>\n</li>\n<li>Loadable\n<ul>\n<li>\n<p>atom 혹은 selector의 최신 상태를 대표. <code>state</code>와 <code>contents</code> 두 가지 데이터를 가짐.</p>\n<table>\n<thead>\n<tr>\n<th>state</th>\n<th>contents</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>hasValue</td>\n<td>실제 값</td>\n</tr>\n<tr>\n<td>hasError</td>\n<td>Error 객체</td>\n</tr>\n<tr>\n<td>loading</td>\n<td>toPromise()</td>\n</tr>\n<tr>\n<td>를 사용하여 값의 Promise</td>\n<td></td>\n</tr>\n<tr>\n<td>를 얻을 수 있음</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"hooks\" style=\"position:relative;\"><a href=\"#hooks\" aria-label=\"hooks permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hooks</h3>\n<ul>\n<li>state 관련\n<ul>\n<li><a href=\"https://recoiljs.org/ko/docs/api-reference/core/useRecoilState\">useRecoilState()</a>: 읽기, 쓰기 가능</li>\n<li><a href=\"https://recoiljs.org/ko/docs/api-reference/core/useRecoilValue\">useRecoilValue()</a>: 읽기 전용(getter return)</li>\n<li><a href=\"https://recoiljs.org/ko/docs/api-reference/core/useSetRecoilState\">useSetRecoilState()</a>: 쓰기 전용(setter return)</li>\n<li><a href=\"https://recoiljs.org/ko/docs/api-reference/core/useResetRecoilState\">useResetRecoilState()</a>: default state로 리셋</li>\n<li><a href=\"https://recoiljs.org/ko/docs/api-reference/core/useRecoilStateLoadable\">useRecoilStateLoadable()</a>: 비동기 selector의 값 읽기, 쓰기 가능. Loadable 객체 반환</li>\n<li><a href=\"https://recoiljs.org/ko/docs/api-reference/core/useRecoilValueLoadable\">useRecoilValueLoadable()</a>: 비동기 selector의 값 읽기 전용. Loadable 객체 반환</li>\n<li><a href=\"https://recoiljs.org/ko/docs/api-reference/core/useGetRecoilValueInfo\">useGetRecoilValueInfo()</a>: 하나의 atom 혹은 selector의 현재 상태, 값,기타 다른 정보 peek</li>\n<li><a href=\"https://recoiljs.org/ko/docs/api-reference/core/useRecoilRefresher\">useRecoilRefresher()</a>: 연관된 모든 캐시를 삭제하고 selector를 호출할 수 있는 콜백을 반환</li>\n<li><a href=\"https://recoiljs.org/ko/docs/api-reference/core/isRecoilValue\">isRecoilValue()</a>: value가 atom이나 selector일 경우 true 반환</li>\n</ul>\n</li>\n<li>concurrency mode 관련\n<ul>\n<li>useRecoilTransaction()</li>\n</ul>\n</li>\n<li>기타\n<ul>\n<li>useRecoilCallback()</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"utils\" style=\"position:relative;\"><a href=\"#utils\" aria-label=\"utils permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Utils</h3>\n<ul>\n<li><a href=\"https://recoiljs.org/ko/docs/api-reference/utils/atomFamily\">atomFamily()</a>: atom과 유사하지만, 매개변수로 전달한 키를 이용하여 동일한 상태를 가진 여러 개의 atom 생성 가능</li>\n<li><a href=\"https://recoiljs.org/ko/docs/api-reference/utils/selectorFamily/\">selectorFamily()</a>: selector와 유사하지만,  get, set, selector의 콜백을 매개변수로 전달하여 동일한 상태를 가진 여러개의 selector 생성 가능.</li>\n<li>constSelector()</li>\n<li>errorSelector()</li>\n<li>noWait()</li>\n<li>waitForAll()</li>\n<li>waitForAllSettled()</li>\n<li>waitForNone()</li>\n<li>waitForAny()</li>\n</ul>\n<h2 id=\"폴더구조\" style=\"position:relative;\"><a href=\"#%ED%8F%B4%EB%8D%94%EA%B5%AC%EC%A1%B0\" aria-label=\"폴더구조 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>폴더구조</h2>\n<p><code>recoil</code> 폴더 아래 data source 별로 나누고, 하위에 <code>atoms, selectors, hooks</code> 를 두도록 폴더 구조를 설계하자. 또한 외부에서 recoil state를 사용할때 직접적으로 atoms, selectors를 접근해서 사용하는 방식이 아닌 관련 data Source의 custom hook을 접근해서 사용하는 방법을 추천하고 있다.</p>\n<p>추가적인 내의견을 덧붙이면 hook 파일의 이름은 <code>use-</code> prefix 로 짓는 것이 가독성이 높은 것 같다.</p>\n<ul>\n<li>\n<p><a href=\"https://github.com/facebookexperimental/Recoil/issues/27\">Suggested folder structure for atoms and selectors</a></p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">├── App.tsx</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">├── index.tsx</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">└── src</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    ├── components</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    │   └── TodoItem.tsx</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    └── recoil</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        |── todo</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            └── atoms.ts</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            └── selectors.ts</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">            └── useTodo.ts</span></span></code></pre>\n<ul>\n<li>recoil 하위에 data source 별로 나누자</li>\n<li>data source 하위에 atoms, selectors, hooks를 두자</li>\n<li>public interface에서는 atom이나 selector를 직접 import해서 사용하는 방식이 아닌, 한번 wrapping한 hook을 통해서 사용하기</li>\n<li>\n<ul>\n<li>내의견 = hook 파일명을 <code>use-</code> prefix를 사용해서 만드는 것이 가독성이 높음</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>참고자료</p>\n<ul>\n<li><a href=\"https://wes-rast.medium.com/recoil-project-structure-best-practices-79e74a475caa\">Recoil Project Structure Best Practices</a>\n<ul>\n<li><a href=\"https://codesandbox.io/s/recoil-good-structure-iprvo?from-embed=&#x26;file=/src/recoil/example/index.ts\">좋은 예시</a>, <a href=\"https://codesandbox.io/s/recoil-bad-structure-91l7c?from-embed\">나쁜 예시</a></li>\n<li>가져올만한 교훈 = data source 별로 나누자</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"참고\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고</h2>\n<ul>\n<li><a href=\"https://recoiljs.org/\">https://recoiljs.org/</a></li>\n</ul>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","excerpt":"React 18로 버전업 하면서 프로젝트에 Recoil을 도입했는데, 그 과정에서 고민했던 내용을 기록차 남겨본다.\n TL;DR; 개념 정리나 장단점 비교에 대해서는 이미 알고 계신분들도 있을 것 같아서 폴더구조나 Redux를 대체하는게 맞는가에 대해서만 먼저 간단하게 요약한 내용을 공유한다. 1. 폴더 구조는 data source 별로 나누자 Suggested folder structure for atoms and selectors recoil 폴더 하위에 data source 별로 나누자 data source 하위에 atoms, selectors, hooks를 두자 2. concurrency mode 사용하려면 Redux는 버리고 Recoil로 넘어가야하나? useSyncExternalStore hook 을 사용해서 Redux에서도 동시성 모드를 사용할 수 있다. 이 부분에 대해서 고민해 본 내용은 아래에.. Recoil 도입 배경 Recoil은 Facebook에서 개발한 상태…","frontmatter":{"date":"April 08, 2023","title":"Recoil 도입기(feat. 폴더구조)","categories":"react","author":"soobing"},"fields":{"slug":"/react/recoil-introduction/"}},"next":{"id":"e19abd3b-8537-528d-a31e-3a74ebbb5cc5","html":"<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p><a href=\"https://github.com/TanStack/query/issues/1077\">#1077</a> 이슈를 보면 mutateFn의 variable을 필수값으로 변경한 이력을 볼 수 있다.</p>\n<p>mutation인데 왜 variable이 없냐고? 나의 경우에는 URL의 있는 queryParams를 읽어와서 데이터를 넘겨주면 되기 때문에 useSomething hook 안에서 처리하고 싶었다.</p>\n<h2 id=\"문제상황\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C%EC%83%81%ED%99%A9\" aria-label=\"문제상황 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>문제상황</h2>\n<p><code>mutate()</code> 와 같이 variable에 아무 값도 넣지 않고 mutation 함수를 호출 할 수 없다.\nTVariables 타입에 undefined도 줘보고 이래저래 별짓을 다해봐도 필수값을 optional 하게 바꿀수는 없었다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// 정의</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">useSomething</span><span class=\"mtk1\"> () {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> {</span><span class=\"mtk12\">name</span><span class=\"mtk1\">} = </span><span class=\"mtk11\">useQueryParams</span><span class=\"mtk1\">(); </span><span class=\"mtk3\">// custom hook이 있다고 가정</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk11\">useMutation</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">mutationFn</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> () </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">axios</span><span class=\"mtk1\">.</span><span class=\"mtk11\">post</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;/user&#39;</span><span class=\"mtk1\">, {</span><span class=\"mtk12\">name</span><span class=\"mtk1\">}),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// 사용처</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> {</span><span class=\"mtk12\">mutate</span><span class=\"mtk1\">} = </span><span class=\"mtk11\">useSomething</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk11\">handleClick</span><span class=\"mtk1\"> = () </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk11\">mutate</span><span class=\"mtk1\">(); </span><span class=\"mtk3\">// 에러 발생</span></span></span></code></pre>\n<p>에러 발생\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 501px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVklEQVQoz22Q3ZKcIBBGfZIdQFERRcD/2XEzudiqff8XOikwmSSVXJz6+mugu+mirFr65cH5+YVbIvX5jj3u1INHmw6p9UVZIaufJP/SK1aqRAhJYYKnez7p9xNjHWKwyDgivKMKI9USUeuEXCbqGFBhRM0RtUyoObzi1lrETVKkLvV+ED++o61FBk9lDOLthriJSzPiD/0P6a5UFNZ0NMuC+TixIVI5j95mlNaUqkSVJWV5femXSqWQSaW6UOoVF6MPzHFisAOdsUQf2bcD50bG0RNCwPuAMR3DMNC2Ju8q8Soo1csX2q3o6RvGbzTxgWhH3rolP973IxfrOkvfDzlOjaZpzmcpH0LMuRhjnr7ow4ZbTuLxJKwPRN1TNwZre4bBZU3FklaVzmhdZ9IKfud09kXVz6h+Q7g7ql8p3U5aw3EcbNvOum7c7+95orpu/qJp2n/8DxPS7dwODauOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"trouble.png\"\n        title=\"trouble.png\"\n        src=\"/static/7c42056008a94dcf63147142441203e5/55811/trouble.png\"\n        srcset=\"/static/7c42056008a94dcf63147142441203e5/e9ff0/trouble.png 180w,\n/static/7c42056008a94dcf63147142441203e5/f21e7/trouble.png 360w,\n/static/7c42056008a94dcf63147142441203e5/55811/trouble.png 501w\"\n        sizes=\"(max-width: 501px) 100vw, 501px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"해결\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0\" aria-label=\"해결 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결</h2>\n<p>실질적으로는 mute 함수에서 variable을 정의해서 넣어주는 것이기 때문에 그렇게 꼼수해결법도 아니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"tsx\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// 정의</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">useSomething</span><span class=\"mtk1\"> () {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> {</span><span class=\"mtk12\">name</span><span class=\"mtk1\">} = </span><span class=\"mtk11\">useQueryParams</span><span class=\"mtk1\">(); </span><span class=\"mtk3\">// custom hook이 있다고 가정</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">mutation</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">useApiMutation</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">mutationFn</span><span class=\"mtk12\">:</span><span class=\"mtk1\"> () </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">axios</span><span class=\"mtk1\">.</span><span class=\"mtk11\">post</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;/user&#39;</span><span class=\"mtk1\">, {</span><span class=\"mtk12\">name</span><span class=\"mtk1\">}),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk11\">mutate</span><span class=\"mtk1\"> = (</span><span class=\"mtk12\">variables</span><span class=\"mtk1\"> = {}) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">mutation</span><span class=\"mtk1\">.</span><span class=\"mtk11\">mutate</span><span class=\"mtk1\">(</span><span class=\"mtk12\">variables</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> {...</span><span class=\"mtk12\">mutation</span><span class=\"mtk1\">, </span><span class=\"mtk12\">mutate</span><span class=\"mtk1\">};</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// 사용처</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> {</span><span class=\"mtk12\">mutate</span><span class=\"mtk1\">} = </span><span class=\"mtk11\">useSomething</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk11\">handleClick</span><span class=\"mtk1\"> = () </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk11\">mutate</span><span class=\"mtk1\">(); </span><span class=\"mtk3\">// 에러안남</span></span></span></code></pre>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .default-dark .mtk3 { color: #6A9955; }\n  .default-dark .mtk15 { color: #C586C0; }\n  .default-dark .mtk1 { color: #D4D4D4; }\n  .default-dark .mtk4 { color: #569CD6; }\n  .default-dark .mtk11 { color: #DCDCAA; }\n  .default-dark .mtk12 { color: #9CDCFE; }\n  .default-dark .mtk8 { color: #CE9178; }\n  .default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","frontmatter":{"date":"February 15, 2023","title":"[react-query] useMutation에서 variable 옵셔널하게 사용하기","categories":"react troubleshooting","author":"soobing"},"fields":{"slug":"/trouble-shooting/how-to-use-variable-optional-in-useMutation/"}},"prev":{"id":"7dd77d91-4c83-5f76-92b0-9e9b60089ea7","html":"<p>Date와 인연이 깊은지 <code>날짜 선택 UI</code>를 custom 해서 개발해야 하는 경험을 두 번째 하게 되었다.</p>\n<p>mui datepicker를 붙이기엔 너무 과해서  <a href=\"https://github.com/wojtekmaj/react-calendar\">react-calendar</a> 라이브러리를 사용하려고 했는데, 문제는 input은 함께 딸려오지 않기 때문에 input 관련 interaction은 직접 구현해야 했다. 인 하우스용 서비스라 여러 라이브러리 참고해서 직접 인터렉션을 정의하고 구현해 보았는데 기록 차 경험을 남겨본다!</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABYlAAAWJQFJUiTwAAACxElEQVQ4y3VUW27bMBD0EXuP3qi/BXqUoh9taid+KrYVx3b8lmVb4pucYlZRkxToAoQoLnc4O7tkJwKwoRnTpyXuhxPctIN2CbXxMEajNa01+v0+yrJESgnee/nS+OXo/Bwt8Wv4hOeDwnR1xijf4+Vssb14PJ8clrsS69USh8NBALfbLaqqEjBrLbQ2eG+dbrbCfbZEvimxLS22pcHqWGN9rOSQQ1njeNijKAoB1FqhrivcbjcBvt2u8N4JeAgBnRgjKmUQYoLSFto6uBDhQ4I2FqPhALPZDMPhEKvVSliQHYN5ANM0xkCpugGk01nb6BCjjNZiCDgejzifz7hcLqjr+kN6BGgOCG8MCfivtUL/z97723mMQZhLypPJBM45KKUwn89lA5mRFY0pkwH3LBYLWTsVBXb7vczneY7r9QpiCUMKTrqc09G2iH2VguLTz9H6jVLQVdX4z2f5l5TZZ/v9XgCoEYXnSVxjqzCl9XotoBR/v9vBxYhYnOBfXhoNp1PY0xEBqWFIMIJwMIhGdi3D9371WphorQzR0Rh4a+DboozHYwFib1FP2nK5/Nsmg8FA9OVe+lkG97yAWzd+Mx7Dnk5vDNvNwkApSZPsOKfxy4LQT7aB7cX/173JaHhVwwePDgN5P1lRbiZbBpIdq0sbjUZSdQIP+n1YFmi7gZk+gl1jJzOY7QEhoWHY3s22ijyV4C1brpEh97BwoqeqEWs+Dt8Rqy9w6ht8KNFxzgoTBhH44eFBAqhhnucCyDXeFvofswzWe/jVM+x8gxS/wk4+wew+I6RdkzLB2teDqROEwe1V4xoZcvDpiikhkmmlgLRBvP2AVz2EoNFhYLfblaCiOKHX6wl4lmWYTqfClg8Dm5/j990dbPCweQ6dTcCrr/uP0JsjQkpvd7nRsJmTCdA8mJSkeQg++l2K8KDfNN/g5D7/AYN9aw1rm9c4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"calendar\"\n        title=\"calendar\"\n        src=\"/static/a3877776b01abc4459873624562e1cce/37523/calendar.png\"\n        srcset=\"/static/a3877776b01abc4459873624562e1cce/e9ff0/calendar.png 180w,\n/static/a3877776b01abc4459873624562e1cce/f21e7/calendar.png 360w,\n/static/a3877776b01abc4459873624562e1cce/37523/calendar.png 720w,\n/static/a3877776b01abc4459873624562e1cce/3c051/calendar.png 760w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"tldr\" style=\"position:relative;\"><a href=\"#tldr\" aria-label=\"tldr permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TL;DR;</h2>\n<ul>\n<li>전체 구현 결과물은 <a href=\"https://codesandbox.io/s/date-input-zux23t?file=/src/components/DatePicker.tsx:0-3603\">code sandbox</a>에서 확인할 수 있다.</li>\n<li>DatePicker 컴포넌트를 개발해 보자! (calendar는 라이브러리를 사용)</li>\n<li>딱히 input에 대한 큰 요구사항이 없이 기능 개발을 해야 하는 경우 그냥 <a href=\"https://projects.wojtekmaj.pl/react-date-picker/\">react-date-picker</a>를 써라</li>\n</ul>\n<h2 id=\"datepicker-컴포넌트-개발\" style=\"position:relative;\"><a href=\"#datepicker-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EA%B0%9C%EB%B0%9C\" aria-label=\"datepicker 컴포넌트 개발 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DatePicker 컴포넌트 개발</h2>\n<iframe src=\"https://codesandbox.io/embed/date-input-zux23t?fontsize=14&hidenavigation=1&theme=dark\"\n     style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\"\n     title=\"date-input\"\n     allow=\"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking\"\n     sandbox=\"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts\"\n   ></iframe>\n<h3 id=\"dependency\" style=\"position:relative;\"><a href=\"#dependency\" aria-label=\"dependency permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>dependency</h3>\n<ul>\n<li><a href=\"https://github.com/wojtekmaj/react-calendar\">react-calendar</a></li>\n<li><a href=\"https://day.js.org/\">dayjs</a></li>\n</ul>\n<h3 id=\"props-설계\" style=\"position:relative;\"><a href=\"#props-%EC%84%A4%EA%B3%84\" aria-label=\"props 설계 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>props 설계</h3>\n<ul>\n<li><code>minDate, maxDate</code>: date range를 지원해야하므로 최소/최대 날짜 값 필요</li>\n<li><code>placeholder</code>: input의 placeholder</li>\n<li><code>value, setValue</code>: 현재 선택된 Date\n<ul>\n<li>부모가 value값을 controll</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"input-요구사항\" style=\"position:relative;\"><a href=\"#input-%EC%9A%94%EA%B5%AC%EC%82%AC%ED%95%AD\" aria-label=\"input 요구사항 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Input 요구사항</h3>\n<ul>\n<li>일단 숫자만 받도록 할 것</li>\n<li>input 값이 들어올때마다 구분자 dash로 <code>년-월-일</code>을 구분한다</li>\n<li>input value의 maxlength는 10자리 (ex. 2023-04-23)</li>\n<li>비정상적인 value의 경우 <code>dayjs</code> 이용해서 보정이 필요 (ex. 2023-90-10 → 2030-06-10)</li>\n</ul>\n<h2 id=\"input-인터렉션\" style=\"position:relative;\"><a href=\"#input-%EC%9D%B8%ED%84%B0%EB%A0%89%EC%85%98\" aria-label=\"input 인터렉션 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Input 인터렉션</h2>\n<p>아래와 같이 정의해서 구현해보았다.</p>\n<ul>\n<li>1자리 (ex. 1) → 월</li>\n<li>2자리 (ex. 10) → 일</li>\n<li>3, 4자리 (ex. 202, 2023) → 년</li>\n<li>5, 8자리 → 체크할 필요 없음 <code>-</code> 로 구분되는 케이스</li>\n<li>6, 7자리 (ex. 2023-1, 2023-11) → 월</li>\n<li>9, 10자리 (ex. 2023-11-2, 2023-11-20) → 일</li>\n</ul>\n<pre class=\"grvsc-container default-dark\" data-language=\"jsx\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">React</span><span class=\"mtk1\">, { </span><span class=\"mtk12\">useState</span><span class=\"mtk1\">, </span><span class=\"mtk12\">useRef</span><span class=\"mtk1\"> } </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;react&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Calendar</span><span class=\"mtk1\"> </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;react-calendar&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;react-calendar/dist/Calendar.css&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">useOnClickOutside</span><span class=\"mtk1\"> </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;../hooks/useOnClickOutside&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">dayjs</span><span class=\"mtk1\"> </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;dayjs&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">DatePicker</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">placeholder</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">value</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">setValue</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">minDate</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">maxDate</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">label</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">divRef</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">useRef</span><span class=\"mtk1\">(</span><span class=\"mtk4\">null</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">inputRef</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">useRef</span><span class=\"mtk1\">(</span><span class=\"mtk4\">null</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> [</span><span class=\"mtk12\">showCalendar</span><span class=\"mtk1\">, </span><span class=\"mtk12\">setShowCalendar</span><span class=\"mtk1\">] = </span><span class=\"mtk11\">useState</span><span class=\"mtk1\">(</span><span class=\"mtk4\">false</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setValueToInput</span><span class=\"mtk1\"> = (</span><span class=\"mtk12\">v</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">inputRef</span><span class=\"mtk1\">.</span><span class=\"mtk12\">current</span><span class=\"mtk1\"> &amp;&amp;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    (</span><span class=\"mtk12\">inputRef</span><span class=\"mtk1\">.</span><span class=\"mtk12\">current</span><span class=\"mtk1\">.</span><span class=\"mtk12\">value</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">dayjs</span><span class=\"mtk1\">(</span><span class=\"mtk12\">v</span><span class=\"mtk1\">).</span><span class=\"mtk11\">format</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;YYYY-MM-DD&quot;</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">useOnClickOutside</span><span class=\"mtk1\">(</span><span class=\"mtk12\">divRef</span><span class=\"mtk1\">, () </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">setShowCalendar</span><span class=\"mtk1\">(</span><span class=\"mtk4\">false</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">value</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">inputRef</span><span class=\"mtk1\">.</span><span class=\"mtk12\">current</span><span class=\"mtk1\">?.</span><span class=\"mtk12\">value</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk11\">setValueToInput</span><span class=\"mtk1\">(</span><span class=\"mtk12\">value</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span></code></pre>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .default-dark .mtk15 { color: #C586C0; }\n  .default-dark .mtk1 { color: #D4D4D4; }\n  .default-dark .mtk12 { color: #9CDCFE; }\n  .default-dark .mtk8 { color: #CE9178; }\n  .default-dark .mtk4 { color: #569CD6; }\n  .default-dark .mtk11 { color: #DCDCAA; }\n  .default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","frontmatter":{"date":"April 23, 2023","title":"날짜 입력 input 인터렉션 개발기","categories":"feature","author":"soobing"},"fields":{"slug":"/feature/input-date/"}},"site":{"siteMetadata":{"siteUrl":"https://soobing.github.io","comments":{"utterances":{"repo":"soobing/soobing.github.io"}}}}},"pageContext":{"slug":"/react/recoil-introduction/","nextSlug":"/trouble-shooting/how-to-use-variable-optional-in-useMutation/","prevSlug":"/feature/input-date/"}},
    "staticQueryHashes": ["1073350324","2938748437"]}